(saveFormat "7.0")
(date "Thu 30/Mar/2006 15:31:21 ")
(veerev "7.51.7801.0")
(platform "PC")
(execMode v6)
(prefExecMode v9)
(filterNAN 0)
(workspaceStackingOrder M)
(sysconfig
(iodevice "VNA"
(type GPIB)
(gateway "This host")
(channel 9)
(subchannel 16)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(eoiEnabled 1)
(model ""
(standard 488))))
(SaveCF no)
(device 0 ROOTCONTEXT
(properties
(trigMode deg)
(nextID 171)
(popupTitleText "ENA 2-Port ECal Calibration & Data Processing")
(popupMoveable 1)
(deleteGlobals 0))
(deviceList
(device 63 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 2 "WRITE TEXT \"*idn?\" EOL" "READ TEXT x STR"))
(interface
(output 1
(name "x")
(optional yes)))
(implementation
(iopath "VNA")))
(device 64 TEXTDISPLAY
(properties
(name "Intsrument ID"))
(interface
(input 1
(name "Data"))))
(device 79 TEXTDISPLAY
(properties
(name "SweepType"))
(interface
(input 1
(name "Data"))))
(device 92 CONTEXT
(properties
(name "(5) Analysis")
(trigMode deg)
(nextID 62)
(popupTitleText "UserObject")
(popupMoveable 1))
(deviceList
(device 0 FORMULA
(properties
(expr 4 "First=a[0,*];" "Second=a[1,*];" "Third=a[2,*];" "Fourth=a[3,*]"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "First")
(optional yes))
(output 2
(name "Second")
(optional yes))
(output 3
(name "Third")
(optional yes))
(output 4
(name "Fourth")
(optional yes))
(output 5
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 2 XYPLOT
(interface
(input 1
(name "XData")
(lock constraints))
(input 2
(name "S11")
(lock constraints))
(input 3
(name "S21")
(lock constraints)
(optional yes))
(input 4
(name "S12")
(lock constraints)
(optional yes))
(input 5
(name "S22")
(lock constraints)
(optional yes))
(input 6
(type control)
(name "Scales")
(tag "ScalesRecord")
(requires
(datatype Record))
(lock name constraints)
(optional yes))
(input 7
(type control)
(name "Traces")
(tag "TracesRecord")
(requires
(datatype Record))
(lock name constraints)
(optional yes)))
(implementation
(tracePin 2)
(tracePin 3)
(tracePin 4)
(tracePin 5)
(graphMode rectangular)
(autoAutoX)
(autoAutoY)))
(device 8 ENUMCONSTANT
(properties
(name "ChooseFormat"))
(interface
(output 1
(name "Enum")
(lock name constraints))
(output 2
(name "Ordinal")
(lock name constraints)))
(implementation
(value Enum
(values
("dB" 0)
("Phase" 1)
("Lin Mag" 2))
(data  "dB"))
(initValue Text
(data  "dB"))))
(device 10 RECCONST
(properties
(name "Record"))
(interface
(output 1
(name "Record")
(lock name constraints)))
(implementation
(value Record
(schema
(numFields 2)
(fieldName "Scale"
(type Text))
(fieldName "Name"
(type Text)))
(data 
(record
("Scale" "Y")
("Name" "yscale"))))))
(device 11 FORMULA
(properties
(name "rec.field = b")
(expr 1 "rec.Name = b"))
(interface
(input 1
(name "rec")
(optional yes))
(input 2
(name "b")
(optional yes))
(output 1
(name "rec")
(optional yes))))
(device 12 CONTEXT
(properties
(name "SetFormat")
(trigMode deg)
(nextID 5)
(popupTitleText "UserObject")
(popupMoveable 1))
(interface
(input 1
(name "Data")
(optional yes))
(input 2
(name "A")
(optional yes))
(output 1
(type data)
(name "Result")
(lock constraints)
(optional yes)))
(deviceList
(device 0 FORMULA
(properties
(name "V->dB")
(expr 3 "20*log10(clipLower(mag(A),1e-10))" "" ""))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 1 FORMULA
(properties
(name "Phase")
(expr 1 "Phase(a)"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 2 IFTHENELSE
(properties
(cases 3 "a==0" "a==1" "a==2"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Then")
(lock name constraints))
(output 2
(name "Else If")
(lock name constraints))
(output 3
(name "Else If")
(lock name constraints))
(output 4
(name "Else")
(lock name constraints))))
(device 3 FORMULA
(properties
(name "LinMag")
(expr 1 "Abs(a)"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 4 JUNCTION
(properties
(name "JCT"))
(interface
(input 1
(name "A")
(optional yes))
(input 2
(name "B")
(optional yes))
(input 3
(name "C")
(optional yes))
(output 1
(name "Data"))))
(configuration
(connect D2:1 D0:0)
(connect I1:1 D0:1)
(connect D2:2 D1:0)
(connect I1:1 D1:1)
(connect I2:1 D2:1)
(connect D2:3 D3:0)
(connect I1:1 D3:1)
(connect D0:1 D4:1)
(connect D1:1 D4:2)
(connect D3:1 D4:3)
(connect D4:1 O1:1)))
(contextCarrier
(active detail)
(detail
(extent 678 442)
(anchorPt 49 42)
(configuration
(devCarrierFor 0
(active icon)
(icon
(extent 37 15))
(open
(extent 245 80))
(terminals on)
(pinCenter 280 270))
(devCarrierFor 1
(active icon)
(icon
(extent 40 15))
(open
(extent 145 50))
(terminals on)
(pinCenter 270 320))
(devCarrierFor 2
(active open)
(icon)
(open
(extent 60 82))
(terminals on)
(pinCenter 120 340))
(devCarrierFor 3
(active icon)
(icon
(extent 44 15))
(open
(extent 145 50))
(terminals on)
(pinCenter 270 380))
(devCarrierFor 4
(active open)
(icon
(extent 26 25))
(open
(extent 12 62))
(terminals on)
(pinCenter 385 330))
(connect D2:1 D0:0
(points 5 202 310 220 310 220 240 280 240 280 260))
(connect I1:1 D0:1
(points 6 -49 68 10 68 10 120 240 120 240 270 259 270))
(connect D2:2 D1:0
(points 5 202 330 230 330 230 300 270 300 270 310))
(connect I1:1 D1:1
(points 6 -49 68 10 68 10 120 240 120 240 320 247 320))
(connect I2:1 D2:1
(points 4 -49 288 10 288 10 340 57 340))
(connect D2:3 D3:0
(points 3 202 350 270 350 270 370))
(connect I1:1 D3:1
(points 8 -49 68 10 68 10 120 240 120 240 340 230 340 230 380 245 380))
(connect D0:1 D4:1
(points 4 301 270 320 270 320 310 346 310))
(connect D1:1 D4:2
(points 4 292 320 310 320 310 330 346 330))
(connect D3:1 D4:3
(points 4 294 380 310 380 310 350 346 350))
(connect D4:1 O1:1
(points 4 433 330 450 330 450 178 628 178)))
(stackingOrder 2 4 0 1 3))))
(device 13 CONTEXT
(properties
(name "SetFormat")
(trigMode deg)
(nextID 5)
(popupTitleText "UserObject")
(popupMoveable 1))
(interface
(input 1
(name "Data")
(optional yes))
(input 2
(name "A")
(optional yes))
(output 1
(type data)
(name "Result")
(lock constraints)
(optional yes)))
(deviceList
(device 0 FORMULA
(properties
(name "V->dB")
(expr 3 "20*log10(clipLower(mag(A),1e-10))" "" ""))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 1 FORMULA
(properties
(name "Phase")
(expr 1 "Phase(a)"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 2 IFTHENELSE
(properties
(cases 3 "a==0" "a==1" "a==2"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Then")
(lock name constraints))
(output 2
(name "Else If")
(lock name constraints))
(output 3
(name "Else If")
(lock name constraints))
(output 4
(name "Else")
(lock name constraints))))
(device 3 FORMULA
(properties
(name "LinMag")
(expr 1 "Abs(a)"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 4 JUNCTION
(properties
(name "JCT"))
(interface
(input 1
(name "A")
(optional yes))
(input 2
(name "B")
(optional yes))
(input 3
(name "C")
(optional yes))
(output 1
(name "Data"))))
(configuration
(connect D2:1 D0:0)
(connect I1:1 D0:1)
(connect D2:2 D1:0)
(connect I1:1 D1:1)
(connect I2:1 D2:1)
(connect D2:3 D3:0)
(connect I1:1 D3:1)
(connect D0:1 D4:1)
(connect D1:1 D4:2)
(connect D3:1 D4:3)
(connect D4:1 O1:1)))
(contextCarrier
(active detail)
(detail
(extent 678 442)
(anchorPt -3 0)
(configuration
(devCarrierFor 0
(active icon)
(icon
(extent 37 15))
(open
(extent 245 37))
(terminals on)
(pinCenter 290 130))
(devCarrierFor 1
(active icon)
(icon
(extent 40 15))
(open
(extent 145 50))
(terminals on)
(pinCenter 290 230))
(devCarrierFor 2
(active open)
(icon)
(open
(extent 60 82))
(terminals on)
(pinCenter 120 340))
(devCarrierFor 3
(active icon)
(icon
(extent 44 15))
(open
(extent 145 50))
(terminals on)
(pinCenter 300 300))
(devCarrierFor 4
(active open)
(icon
(extent 26 25))
(open
(extent 12 62))
(terminals on)
(pinCenter 415 140))
(connect D2:1 D0:0
(points 5 202 310 220 310 220 100 290 100 290 120))
(connect I1:1 D0:1
(points 6 3 110 10 110 10 120 240 120 240 130 269 130))
(connect D2:2 D1:0
(points 5 202 330 230 330 230 200 290 200 290 220))
(connect I1:1 D1:1
(points 6 3 110 10 110 10 120 240 120 240 230 267 230))
(connect I2:1 D2:1
(points 4 3 330 10 330 10 340 57 340))
(connect D2:3 D3:0
(points 5 202 350 250 350 250 270 300 270 300 290))
(connect I1:1 D3:1
(points 6 3 110 10 110 10 120 240 120 240 300 275 300))
(connect D0:1 D4:1
(points 4 311 130 330 130 330 120 376 120))
(connect D1:1 D4:2
(points 4 312 230 330 230 330 140 376 140))
(connect D3:1 D4:3
(points 4 324 300 340 300 340 160 376 160))
(connect D4:1 O1:1
(points 4 463 140 480 140 480 220 680 220)))
(stackingOrder 2 0 1 3 4))))
(device 14 CONTEXT
(properties
(name "SetFormat")
(trigMode deg)
(nextID 5)
(popupTitleText "UserObject")
(popupMoveable 1))
(interface
(input 1
(name "Data")
(optional yes))
(input 2
(name "A")
(optional yes))
(output 1
(type data)
(name "Result")
(lock constraints)
(optional yes)))
(deviceList
(device 0 FORMULA
(properties
(name "V->dB")
(expr 3 "20*log10(clipLower(mag(A),1e-10))" "" ""))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 1 FORMULA
(properties
(name "Phase")
(expr 1 "Phase(a)"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 2 IFTHENELSE
(properties
(cases 3 "a==0" "a==1" "a==2"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Then")
(lock name constraints))
(output 2
(name "Else If")
(lock name constraints))
(output 3
(name "Else If")
(lock name constraints))
(output 4
(name "Else")
(lock name constraints))))
(device 3 FORMULA
(properties
(name "LinMag")
(expr 1 "Abs(a)"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 4 JUNCTION
(properties
(name "JCT"))
(interface
(input 1
(name "A")
(optional yes))
(input 2
(name "B")
(optional yes))
(input 3
(name "C")
(optional yes))
(output 1
(name "Data"))))
(configuration
(connect D2:1 D0:0)
(connect I1:1 D0:1)
(connect D2:2 D1:0)
(connect I1:1 D1:1)
(connect I2:1 D2:1)
(connect D2:3 D3:0)
(connect I1:1 D3:1)
(connect D0:1 D4:1)
(connect D1:1 D4:2)
(connect D3:1 D4:3)
(connect D4:1 O1:1)))
(contextCarrier
(active detail)
(detail
(extent 678 442)
(anchorPt -3 0)
(configuration
(devCarrierFor 0
(active icon)
(icon
(extent 37 15))
(open
(extent 245 37))
(terminals on)
(pinCenter 290 130))
(devCarrierFor 1
(active icon)
(icon
(extent 40 15))
(open
(extent 145 50))
(terminals on)
(pinCenter 290 230))
(devCarrierFor 2
(active open)
(icon)
(open
(extent 60 82))
(terminals on)
(pinCenter 120 340))
(devCarrierFor 3
(active icon)
(icon
(extent 44 15))
(open
(extent 145 50))
(terminals on)
(pinCenter 300 300))
(devCarrierFor 4
(active open)
(icon
(extent 26 25))
(open
(extent 12 62))
(terminals on)
(pinCenter 415 140))
(connect D2:1 D0:0
(points 5 202 310 220 310 220 100 290 100 290 120))
(connect I1:1 D0:1
(points 6 3 110 10 110 10 120 240 120 240 130 269 130))
(connect D2:2 D1:0
(points 5 202 330 230 330 230 200 290 200 290 220))
(connect I1:1 D1:1
(points 6 3 110 10 110 10 120 240 120 240 230 267 230))
(connect I2:1 D2:1
(points 4 3 330 10 330 10 340 57 340))
(connect D2:3 D3:0
(points 5 202 350 250 350 250 270 300 270 300 290))
(connect I1:1 D3:1
(points 6 3 110 10 110 10 120 240 120 240 300 275 300))
(connect D0:1 D4:1
(points 4 311 130 330 130 330 120 376 120))
(connect D1:1 D4:2
(points 4 312 230 330 230 330 140 376 140))
(connect D3:1 D4:3
(points 4 324 300 340 300 340 160 376 160))
(connect D4:1 O1:1
(points 4 463 140 480 140 480 220 680 220)))
(stackingOrder 2 0 1 3 4))))
(device 15 CONTEXT
(properties
(name "SetFormat")
(trigMode deg)
(nextID 5)
(popupTitleText "UserObject")
(popupMoveable 1))
(interface
(input 1
(name "Data")
(optional yes))
(input 2
(name "A")
(optional yes))
(output 1
(type data)
(name "Result")
(lock constraints)
(optional yes)))
(deviceList
(device 0 FORMULA
(properties
(name "V->dB")
(expr 3 "20*log10(clipLower(mag(A),1e-10))" "" ""))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 1 FORMULA
(properties
(name "Phase")
(expr 1 "Phase(a)"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 2 IFTHENELSE
(properties
(cases 3 "a==0" "a==1" "a==2"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Then")
(lock name constraints))
(output 2
(name "Else If")
(lock name constraints))
(output 3
(name "Else If")
(lock name constraints))
(output 4
(name "Else")
(lock name constraints))))
(device 3 FORMULA
(properties
(name "LinMag")
(expr 1 "Abs(a)"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 4 JUNCTION
(properties
(name "JCT"))
(interface
(input 1
(name "A")
(optional yes))
(input 2
(name "B")
(optional yes))
(input 3
(name "C")
(optional yes))
(output 1
(name "Data"))))
(configuration
(connect D2:1 D0:0)
(connect I1:1 D0:1)
(connect D2:2 D1:0)
(connect I1:1 D1:1)
(connect I2:1 D2:1)
(connect D2:3 D3:0)
(connect I1:1 D3:1)
(connect D0:1 D4:1)
(connect D1:1 D4:2)
(connect D3:1 D4:3)
(connect D4:1 O1:1)))
(contextCarrier
(active detail)
(detail
(extent 678 442)
(anchorPt -3 0)
(configuration
(devCarrierFor 0
(active icon)
(icon
(extent 37 15))
(open
(extent 245 37))
(terminals on)
(pinCenter 290 130))
(devCarrierFor 1
(active icon)
(icon
(extent 40 15))
(open
(extent 145 50))
(terminals on)
(pinCenter 290 230))
(devCarrierFor 2
(active open)
(icon)
(open
(extent 60 82))
(terminals on)
(pinCenter 120 340))
(devCarrierFor 3
(active icon)
(icon
(extent 44 15))
(open
(extent 145 50))
(terminals on)
(pinCenter 300 300))
(devCarrierFor 4
(active open)
(icon
(extent 26 25))
(open
(extent 12 62))
(terminals on)
(pinCenter 415 140))
(connect D2:1 D0:0
(points 5 202 310 220 310 220 100 290 100 290 120))
(connect I1:1 D0:1
(points 6 3 110 10 110 10 120 240 120 240 130 269 130))
(connect D2:2 D1:0
(points 5 202 330 230 330 230 200 290 200 290 220))
(connect I1:1 D1:1
(points 6 3 110 10 110 10 120 240 120 240 230 267 230))
(connect I2:1 D2:1
(points 4 3 330 10 330 10 340 57 340))
(connect D2:3 D3:0
(points 5 202 350 250 350 250 270 300 270 300 290))
(connect I1:1 D3:1
(points 6 3 110 10 110 10 120 240 120 240 300 275 300))
(connect D0:1 D4:1
(points 4 311 130 330 130 330 120 376 120))
(connect D1:1 D4:2
(points 4 312 230 330 230 330 140 376 140))
(connect D3:1 D4:3
(points 4 324 300 340 300 340 160 376 160))
(connect D4:1 O1:1
(points 4 463 140 480 140 480 220 680 220)))
(stackingOrder 2 0 1 3 4))))
(device 16 FROMGLOBAL
(properties
(name "Get Freq")
(globalName "Freq"))
(interface
(output 1
(name "Data")
(tag "Data")
(lock name constraints))))
(device 25 FROMGLOBAL
(properties
(name "Get Params")
(globalName "Params"))
(interface
(output 1
(name "Data")
(tag "Data")
(lock name constraints))))
(device 26 RECCONST
(properties
(name "Record"))
(interface
(output 1
(name "Record")
(lock name constraints)))
(implementation
(value Record
(schema
(numFields 2)
(fieldName "TraceNum"
(type Int32))
(fieldName "Name"
(type Text)))
(data 
(record
("TraceNum" 1)
("Name" "TraceName"))))))
(device 27 FORMULA
(properties
(name "rec.field = b")
(expr 2 "rec.Name = b[i];" "rec.TraceNum=i+1"))
(interface
(input 1
(name "rec")
(optional yes))
(input 2
(name "i")
(optional yes))
(input 3
(name "b")
(optional yes))
(output 1
(name "rec")
(optional yes))))
(device 28 FORCOUNT
(properties
(count 4))
(interface
(output 1
(name "Count")
(lock name constraints))))
(device 40 GATE
(interface
(input 1
(name "A")
(tag "InData"))
(output 1
(name "X"))))
(device 39 EXITPROCESS
(properties
(code 0)))
(device 38 EXITPROCESS
(properties
(code 0)))
(device 44 MESSAGEBOX
(properties
(message "Need At Least 4 Parameters measured")
(symbol Information))
(interface
(output 1
(name "OK")
(lock name constraints)))
(implementation
(customButtons 0)
(displayMode 3)
(buttons "OK")
(buttonLabel1 "OK")
(buttonLabel2 "")
(buttonLabel3 "")
(bdefault "OK")))
(device 43 MESSAGEBOX
(properties
(message "No Data Found")
(symbol Information))
(interface
(output 1
(name "OK")
(lock name constraints)))
(implementation
(customButtons 0)
(displayMode 3)
(buttons "OK")
(buttonLabel1 "OK")
(buttonLabel2 "")
(buttonLabel3 "")
(bdefault "OK")))
(device 42 IFTHENELSE
(properties
(cases 1 "A<=2"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Then")
(lock name constraints))
(output 2
(name "Else")
(lock name constraints))))
(device 41 FROMFUNCTION
(interface
(input 1
(name "Function")
(tag "Function"))
(output 1
(name "Array")
(tag "Array")
(lock name constraints))
(output 2
(name "Dim 1 Map")
(tag "Dim 1 Map")
(lock name constraints))
(output 3
(name "Dim 1 From")
(tag "Dim 1 From")
(lock name constraints))
(output 4
(name "Dim 1 To")
(tag "Dim 1 To")
(lock name constraints))
(output 5
(name "Dim 2 Map")
(tag "Dim 2 Map"))
(output 6
(name "Dim 2 From")
(tag "Dim 2 From"))
(output 7
(name "Dim 2 To")
(tag "Dim 2 To")))
(implementation
(numDims 2)))
(device 45 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Here we first select the data source, difference, corrected, or raw.  Then if need be we compute the difference between the corrected and uncorrected data and do some checks to make sure it\'s valid for our display.  Here we use the subtractive difference for S11, S22, and the dB difference (which is ratio) for S21, S12).  We do this because S11 and S22 are reflection parameters and for ideal devices reflections should be zero and therefore a subtraction is appropriate.  S12 and S21 on the other hand are transmission paramters and ideal devices have a transmission value of 1 and therefore a ratio is a more appropriate operation.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 46 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 \"SetFormat\" is a user object repeated 4 times that formats the data based on the choosen format index\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 47 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 These controls are a cool way of setting up a custom graph or XY chart.  A record with the attributes Scale and Name let you set the y scale to \"dB\" or \"phase\";  A record with the attributes TraceNum and Name let you rename the traces (we set them to the parameter names).\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 48 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 We placed this xy plot on the panel view\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 49 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 We placed this list box on the panel view\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 53 ENUMCONSTANT
(properties
(name "Data Selector"))
(interface
(output 1
(name "Enum")
(lock name constraints))
(output 2
(name "Ordinal")
(lock name constraints)))
(implementation
(value Enum
(values
("Delta" 0)
("Corrected" 1)
("Raw" 2))
(data  "Delta"))
(initValue Text
(data  "Delta"))))
(device 54 IFTHENELSE
(properties
(name "Which Data?")
(cases 3 "A==\"Delta\"" "A==\"Corrected\"" "A==\"Raw\""))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Then")
(lock name constraints))
(output 2
(name "Else If")
(lock name constraints))
(output 3
(name "Else If")
(lock name constraints))
(output 4
(name "Else")
(lock name constraints))))
(device 55 FORMULA
(properties
(name "CorrData - RawData")
(expr 5 "A=CorrData; // init result container"
"A[0,*]=CorrData[0,*]- RawData[0,*]; //S11"
"A[1,*]=CorrData[0,*]/ RawData[1,*]; //S12"
"A[2,*]=CorrData[0,*]/ RawData[2,*]; //S21"
"A[3,*]=CorrData[0,*]- RawData[3,*]; //S22"))
(interface
(output 1
(name "A")
(optional yes))
(output 2
(type exception)
(name "Error")
(lock name constraints)
(optional yes))))
(device 56 FROMGLOBAL
(properties
(name "Get CorrData")
(globalName "CorrData"))
(interface
(output 1
(name "Data")
(tag "Data")
(lock name constraints))
(output 2
(type exception)
(name "Error")
(lock name constraints)
(optional yes))))
(device 57 FROMGLOBAL
(properties
(name "Get RawData")
(globalName "RawData"))
(interface
(output 1
(name "Data")
(tag "Data")
(lock name constraints))
(output 2
(type exception)
(name "Error")
(lock name constraints)
(optional yes))))
(device 58 JUNCTION
(properties
(name "JCT"))
(interface
(input 1
(name "A")
(optional yes))
(input 2
(name "B")
(optional yes))
(input 3
(name "C")
(optional yes))
(output 1
(name "Data"))))
(device 59 JUNCTION
(properties
(name "JCT"))
(interface
(input 1
(name "A")
(optional yes))
(input 2
(name "B")
(optional yes))
(input 3
(name "C")
(optional yes))
(output 1
(name "Data"))))
(device 60 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fscript\\fprq2\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 This is a user object that has a panel view.  The panel view of a user object can in turn be placed in the panel view of the parent object.  In this case the panel view of this object is placed in the main panel.  This approach helps with organization and grouping of related panel objects and creates a cleaner detail view for the parent object.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 61 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 We placed this list box on the panel view\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(configuration
(connect D9:0 D0:0)
(connect D14:1 D0:1)
(connect D9:1 D1:1)
(connect D5:1 D1:2)
(connect D6:1 D1:3)
(connect D7:1 D1:4)
(connect D8:1 D1:5)
(connect D4:1 D1:6)
(connect D12:1 D1:7)
(connect D2:0 D3:0)
(connect D3:1 D4:1)
(connect D2:1 D4:2)
(connect D0:1 D5:1)
(connect D2:2 D5:2)
(connect D0:2 D6:1)
(connect D2:2 D6:2)
(connect D0:3 D7:1)
(connect D2:2 D7:2)
(connect D0:4 D8:1)
(connect D2:2 D8:2)
(connect D13:1 D11:0)
(connect D11:1 D12:1)
(connect D13:1 D12:2)
(connect D10:1 D12:3)
(connect D14:1 D13:0)
(connect D19:2 D14:0)
(connect D31:1 D14:1)
(connect D18:1 D15:0)
(connect D17:1 D16:0)
(connect D19:1 D17:0)
(connect D32:1 D18:0)
(connect D20:4 D19:1)
(connect D31:1 D20:1)
(connect D26:1 D27:1)
(connect D27:1 D28:0)
(connect D27:2 D29:0)
(connect D27:3 D30:0)
(connect D28:1 D31:1)
(connect D29:1 D31:2)
(connect D30:1 D31:3)
(connect D28:2 D32:1)
(connect D29:2 D32:2)
(connect D30:2 D32:3)))
(contextCarrier
(active detail)
(panel
(extent 835 358)
(drawGrid "on")
(widget 1 detail
(relativeOrigin 0 50)
(PID 0)
(title off)
(tabIndex 0)
(borderStyle flat)
(extent 756 350)
(displayMode 47)
(graphType cartesian)
(gridType grid)
(scale 0
(name "dB")
(domainName "Freq")
(Yspacing 1)
(Xspacing 2)
(scaleColor "Dark Gray")
(show 1)
(range -50 10 4 linear))
(domain 0 800000000 4 linear)
(trace 0 onScale 0
(name "S11")
(traceColor "Yellow")
(lineType 12)
(pointType 0))
(trace 1 onScale 0
(name "S21")
(traceColor "Cyan")
(lineType 12)
(pointType 0))
(trace 2 onScale 0
(name "S12")
(traceColor "Magenta")
(lineType 12)
(pointType 0))
(trace 3 onScale 0
(name "S22")
(traceColor "Green")
(lineType 12)
(pointType 0))
(marker 0 onTrace 0)
(marker 1 onTrace 1)
(markerInterpolate 1))
(widget 2 detail
(relativeOrigin 0 0)
(PID 1)
(title on)
(tabIndex 1)
(borderStyle flat)
(extent 130 25)
(format dropDown))
(widget 26 detail
(relativeOrigin 140 0)
(PID 2)
(title on)
(tabIndex 2)
(borderStyle flat)
(extent 146 25)
(format dropDown)))
(detail
(extent 1021 866)
(anchorPt 827 301)
(configuration
(devCarrierFor 0
(active open)
(icon)
(open
(extent 155 102))
(terminals on)
(pinCenter 115 210))
(devCarrierFor 2
(active open)
(icon
(iconImage "display.icn"))
(open
(extent 655 297)
(displayMode 47)
(graphType cartesian)
(gridType grid)
(scale 0
(name "dB")
(domainName "Freq")
(Yspacing 1)
(Xspacing 2)
(scaleColor "Dark Gray")
(show 1)
(range -50 10 4 linear))
(domain 0 800000000 4 linear)
(trace 0 onScale 0
(name "S11")
(traceColor "Yellow")
(lineType 12)
(pointType 0))
(trace 1 onScale 0
(name "S21")
(traceColor "Cyan")
(lineType 12)
(pointType 0))
(trace 2 onScale 0
(name "S12")
(traceColor "Magenta")
(lineType 12)
(pointType 0))
(trace 3 onScale 0
(name "S22")
(traceColor "Green")
(lineType 12)
(pointType 0)))
(pinCenter 970 230))
(devCarrierFor 8
(active open)
(icon
(extent 91 0))
(open
(extent 130 25)
(format dropDown))
(pinCenter 120 330))
(devCarrierFor 10
(active open)
(icon)
(open
(extent 171 120)
(formatters))
(pinCenter 120 450))
(devCarrierFor 11
(active open)
(icon)
(open
(extent 113 50))
(terminals on)
(pinCenter 350 450))
(devCarrierFor 12
(active icon)
(icon
(extent 74 25))
(terminals on)
(pinCenter 330 150))
(devCarrierFor 13
(active icon)
(icon
(extent 74 25))
(terminals on)
(pinCenter 330 190))
(devCarrierFor 14
(active icon)
(icon
(extent 74 25))
(terminals on)
(pinCenter 330 240))
(devCarrierFor 15
(active icon)
(icon
(extent 74 25))
(terminals on)
(pinCenter 330 280))
(devCarrierFor 16
(active open)
(icon
(extent 51 0))
(open
(extent 73 51))
(terminals on)
(pinCenter 125 100))
(devCarrierFor 25
(active open)
(icon
(extent 72 0))
(open
(extent 76 51))
(terminals on)
(pinCenter 345 550))
(devCarrierFor 26
(active open)
(icon)
(open
(extent 171 120)
(formatters))
(pinCenter 120 660))
(devCarrierFor 27
(active open)
(icon)
(open
(extent 113 65))
(terminals on)
(pinCenter 360 670))
(devCarrierFor 28
(active open)
(icon
(iconImage "loop.icn"))
(open
(extent 95 31))
(pinCenter -30 540))
(devCarrierFor 40
(active icon)
(icon
(extent 30 15))
(open)
(terminals on)
(pinCenter -110 210))
(devCarrierFor 39
(active icon)
(icon
(extent 68 51)
(iconImage "stop.icn"))
(open
(extent 65 31))
(pinCenter -280 240))
(devCarrierFor 38
(active icon)
(icon
(extent 68 51)
(iconImage "stop.icn"))
(open
(extent 65 31))
(pinCenter -170 400))
(devCarrierFor 44
(active icon)
(icon
(extent 81 15))
(open
(extent 219 126))
(terminals on)
(pinCenter -260 380))
(devCarrierFor 43
(active icon)
(icon
(extent 81 15))
(open
(extent 219 126))
(terminals on)
(pinCenter -350 180))
(devCarrierFor 42
(active open)
(icon)
(open
(extent 58 51))
(terminals on)
(pinCenter -385 320))
(devCarrierFor 41
(active open)
(icon
(extent 83 74)
(iconImage "unbuild.icn"))
(open
(extent 74 142))
(terminals on)
(pinCenter -600 320))
(devCarrierFor 45
(active open)
(icon
(extent 68 51)
(iconImage "notepad.icn"))
(open
(extent 404 206)
(editing enabled))
(pinCenter -480 -230))
(devCarrierFor 46
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter 240 -10))
(devCarrierFor 47
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 414 206)
(editing enabled))
(pinCenter 700 590))
(devCarrierFor 48
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter 790 10))
(devCarrierFor 49
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 244 66)
(editing enabled))
(pinCenter 370 350))
(devCarrierFor 53
(active open)
(icon
(extent 81 0))
(open
(extent 117 25)
(format dropDown))
(pinCenter -830 -50))
(devCarrierFor 54
(active icon)
(icon
(extent 77 45))
(open
(extent 119 82))
(terminals on)
(pinCenter -720 -60))
(devCarrierFor 55
(active icon)
(icon
(extent 122 34))
(open
(extent 374 95))
(terminals on)
(pinCenter -510 -40))
(devCarrierFor 56
(active icon)
(icon
(extent 74 25))
(open
(extent 82 51))
(terminals on)
(pinCenter -610 30))
(devCarrierFor 57
(active icon)
(icon
(extent 80 25))
(open
(extent 83 51))
(terminals on)
(pinCenter -670 90))
(devCarrierFor 58
(active icon)
(icon
(extent 26 34))
(open
(extent 12 62))
(terminals on)
(pinCenter -400 40))
(devCarrierFor 59
(active icon)
(icon
(extent 26 34))
(open
(extent 12 62))
(terminals on)
(pinCenter -400 110))
(devCarrierFor 60
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 424 196)
(editing enabled))
(pinCenter -470 570))
(devCarrierFor 61
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 244 66)
(editing enabled))
(pinCenter -800 30))
(connect D9:0 D0:0
(points 2 130 128 130 138))
(connect D14:1 D0:1
(points 2 -93 210 5 210))
(connect D9:1 D1:1
(points 4 204 100 220 100 220 110 640 110))
(connect D5:1 D1:2
(points 2 369 150 640 150))
(connect D6:1 D1:3
(points 2 369 190 640 190))
(connect D7:1 D1:4
(points 4 369 240 390 240 390 230 640 230))
(connect D8:1 D1:5
(points 4 369 280 390 280 390 270 640 270))
(connect D4:1 D1:6
(points 4 439 450 510 450 510 310 640 310))
(connect D12:1 D1:7
(points 6 449 670 460 670 460 460 520 460 520 350 640 350))
(connect D2:0 D3:0
(points 2 120 345 120 369))
(connect D3:1 D4:1
(points 4 208 450 240 450 240 440 261 440))
(connect D2:1 D4:2
(points 4 187 320 230 320 230 460 261 460))
(connect D0:1 D5:1
(points 4 255 170 280 170 280 140 290 140))
(connect D2:2 D5:2
(points 6 187 340 210 340 210 280 270 280 270 160 290 160))
(connect D0:2 D6:1
(points 4 255 190 280 190 280 180 290 180))
(connect D2:2 D6:2
(points 6 187 340 210 340 210 280 270 280 270 200 290 200))
(connect D0:3 D7:1
(points 4 255 210 280 210 280 230 290 230))
(connect D2:2 D7:2
(points 6 187 340 210 340 210 280 270 280 270 250 290 250))
(connect D0:4 D8:1
(points 6 255 230 270 230 270 240 280 240 280 270 290 270))
(connect D2:2 D8:2
(points 6 187 340 210 340 210 280 270 280 270 290 290 290))
(connect D13:1 D11:0
(points 3 20 540 120 540 120 579))
(connect D11:1 D12:1
(points 4 208 660 230 660 230 650 271 650))
(connect D13:1 D12:2
(points 4 20 540 240 540 240 670 271 670))
(connect D10:1 D12:3
(points 6 425 550 470 550 470 730 250 730 250 690 271 690))
(connect D14:1 D13:0
(points 3 -93 210 -30 210 -30 504))
(connect D19:2 D14:0
(points 5 -314 330 -220 330 -220 180 -110 180 -110 200))
(connect D31:1 D14:1
(points 6 -385 40 -360 40 -360 150 -210 150 -210 210 -128 210))
(connect D18:1 D15:0
(points 3 -307 180 -280 180 -280 212))
(connect D17:1 D16:0
(points 5 -217 380 -210 380 -210 350 -170 350 -170 372))
(connect D19:1 D17:0
(points 3 -314 310 -260 310 -260 370))
(connect D32:1 D18:0
(points 3 -385 110 -350 110 -350 170))
(connect D20:4 D19:1
(points 2 -481 320 -447 320))
(connect D31:1 D20:1
(points 6 -385 40 -360 40 -360 150 -720 150 -720 320 -700 320))
(connect D26:1 D27:1
(points 2 -769 -60 -761 -60))
(connect D27:1 D28:0
(points 3 -679 -80 -510 -80 -510 -60))
(connect D27:2 D29:0
(points 3 -679 -70 -610 -70 -610 15))
(connect D27:3 D30:0
(points 5 -679 -60 -660 -60 -660 -10 -670 -10 -670 75))
(connect D28:1 D31:1
(points 4 -447 -50 -430 -50 -430 30 -416 30))
(connect D29:1 D31:2
(points 4 -571 20 -550 20 -550 40 -416 40))
(connect D30:1 D31:3
(points 4 -628 80 -550 80 -550 50 -416 50))
(connect D28:2 D32:1
(points 4 -447 -30 -440 -30 -440 100 -416 100))
(connect D29:2 D32:2
(points 4 -571 40 -560 40 -560 110 -416 110))
(connect D30:2 D32:3
(points 4 -628 100 -610 100 -610 120 -416 120)))
(stackingOrder 6 7 8 2 3 10 12 1 19 17 16 14 23 24 25 4 5 9 22 0 11 13 29 31 32
27 30 15 18 20 26 33 34 21 28))))
(device 95 TOGLOBAL
(properties
(name "Set CorrData")
(globalName "CorrData"))
(interface
(input 1
(name "Data")
(tag "Data"))))
(device 96 TOGLOBAL
(properties
(name "Set Freq")
(globalName "Freq"))
(interface
(input 1
(name "Data")
(tag "Data"))))
(device 99 NOTE
(properties
(name "Warranty Disclaimer")
(text2 4
"{\\rtf1\\ansi\\deff0{\\fonttbl{\\f0\\fnil\\fcharset0 Courier New;}}\r\n\\viewkind4\\uc1\\pard\\lang1033\\f0\\fs18 This example is provided as an\\par\r\nillustration \"as is\", and Keysight Technologies\\par\r\nmakes no warranty of any kind\\par\r\nwith regard to this example.\\par\r\n}\r\n"
"illustration \"as is\", and Keysight Technologies"
"makes no warranty of any kind" "with regard to this example.")))
(device 100 NOTE
(properties
(name "Requirements")
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue0;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24  - Need to have VEE Pro 7.0 and above to run this example.\\par\r\n - Need to have a PNA (all model numbers and firmware versions above \\par\r\n   A.03.01 are suported)\\par\r\n - Need to have installed a IO interface type: GPIB (ex: Keysight 82350B), \\par\r\n   LAN/GPIB(ex: Keysight E5810A) or USB/GPIB (ex: Keysight 82357A) or SICL/LAN connection to the instrument.\\par\r\n - Need to have installed some IO software: Keysight IO libraries version Suite 14.0 \\par\r\n   as a minimum.\\par\r\n- Change the VNA \"Direct I/O\" under the I/O manager to point to your PNA\\par\r\n\\par\r\nNote that this example is using a GPIB interface. The instrument is at the address 716 on the GPIB bus.\\par\r\n}\r\n"
)))
(device 101 NOTE
(properties
(name "Programming Sample Goal")
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Microsoft Sans Serif;}}\r\n{\\colortbl ;\\red0\\green0\\blue0;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs17 The goal in this application is to setup 4 s-parameter measurements  (S11, S12, S21, S22) in a channel selected by the user, Calibrate the channel using a 2-port guided ECal procedure, and display either the corrected, the raw, or the difference between the corrected and raw S-parameters. Each of the program blocks were written using the best practices in controlling and reading data on a PNA.  Read the notes inside of each block to get details on why each command is sent. \\par\r\n\\par\r\nThe \\ldblquote Driving Data\\rdblquote  block can be used to select the channel, start and stop frequencies of the sweep, the IF Bandwidth of the channel, and the number of points used in the channel.  \\par\r\n\\par\r\nAfter all the setup information is entered, the user can initiate a measurement by pressing the \\ldblquote Begin Measurement\\rdblquote  button.  The application will setup the PNA channel as prescribed, and calibrate and measure the parameters that are specified.  The data is transferred between the PNA and the application in Real/Imaginary format, but it is displayed in the trace window in the format selected by the user in the \\ldblquote Choose Format\\rdblquote  drop-down selection list.  The formatting of the data takes place in the analysis block of the example code.  The user can also select which data to display by choosing one of the options in the \"Data Selector\" drop-down list in the analysis block.\\par\r\n\\par\r\n}\r\n"
)))
(device 124 REPEATUNTILBREAK
(interface
(output 1
(name "Continuous")
(lock name constraints))))
(device 125 CONFIRM25
(properties
(name "New Measurement")
(enterButton 1)
(escapeButton 0)
(isAssigned2FKey None))
(interface
(output 1
(name "Go")
(lock name constraints)))
(implementation))
(device 126 CONFIRM25
(properties
(name "Finished")
(enterButton 0)
(escapeButton 1)
(isAssigned2FKey None))
(interface
(output 1
(name "Go")
(lock name constraints)))
(implementation))
(device 127 BREAK)
(device 128 NEXT)
(device 130 NOTE
(properties
(name "Notes on VNA measurements")
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\froman\\fprq2\\fcharset0 Times New Roman;}{\\f1\\fnil\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;\\red0\\green0\\blue0;}\r\n\\viewkind4\\uc1\\pard\\cf1\\b\\f0\\fs28 First: Don\'t Panic!\\par\r\n\\cf2\\b0\\f1\\fs26 Making measurements and calibrating with a VNA is easy and fun!\\par\r\nThere are 5 basic steps:\\par\r\n1) Setting up which parameters to measure\\par\r\n2) Setting up the sweep parameters (freq, points)\\par\r\n3) Performing the calibration\\par\r\n4) Reading the data\\par\r\n5) Formating and displaying the results.\\par\r\n\\par\r\n}\r\n"
)))
(device 131 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Set up the parameters to measure\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 132 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Set up channel with freq, points, etc\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 134 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;\\red255\\green0\\blue0;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Do a 2-Port ECal\\par\r\n\\cf2\\fs18\\par\r\n}\r\n"
)))
(device 136 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Now we get the Frequency list, and read out all the corrected data, and place them into a global 4D array\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 137 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Finally, we compute the difference between each of the 4 corrected and uncorrected S-Parameters and display the results.  We take the subtractive difference for S11, S22, and the dB difference (ratio) for S12, S21. We do this because S11 and S22 are reflection parameters and for ideal devices reflections should be zero and therefore a subtraction is appropriate.  S12 and S21 on the other hand are transmission paramters and ideal devices have a transmission value of 1 and therefore a ratio is a more appropriate operation.\\b\\f1\\fs28\\par\r\n\\b0\\f0\\fs24\\par\r\n}\r\n"
)))
(device 138 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 The first time through, one sweep happens.\\par\r\nTo sweep again, hit \"New Measurement\".\\par\r\nTo stop, hit \"Finished\"\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 139 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 This keeps it running so you can change things\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 140 CONTEXT
(properties
(name "Check ECAL Connection")
(trigMode deg)
(nextID 46)
(popupTitleText "UserObject")
(popupMoveable 1))
(deviceList
(device 3 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 5 "WRITE TEXT \"*cls\" EOL"
"WRITE TEXT \"SENS:CORR:COLL:ECAL:PATH? 1\" EOL" "READ TEXT x INT32"
"WRITE TEXT \"Sens:corr:coll:ecal:path? 2\" EOL" "READ TEXT y INT32"))
(interface
(input 1
(type control)
(name "Timeout")
(requires
(datatype Real64)
(shape "Scalar"))
(lock name constraints)
(optional yes))
(output 1
(name "x")
(optional yes))
(output 2
(name "y")
(optional yes))
(output 3
(type exception)
(name "Error")
(lock name constraints)
(optional yes)))
(implementation
(iopath "VNA")))
(device 25 EXITPROCESS
(properties
(code 0)))
(device 26 MESSAGEBOX
(properties
(timeout 5)
(position 201 201)
(message "Error reading ECAL.  The program will stop.")
(symbol Stop))
(interface
(output 1
(name "OK")
(lock name constraints)))
(implementation
(customButtons 0)
(displayMode 3)
(buttons "OK")
(buttonLabel1 "OK")
(buttonLabel2 "")
(buttonLabel3 "")
(bdefault "OK")))
(device 33 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fscript\\fprq2\\fcharset0 Comic Sans MS;}{\\f1\\fnil\\fcharset0 Comic Sans MS;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 In this we look to see if the ecal is connected to ports 1 and 2.\\f1\\par\r\n}\r\n"
)))
(device 12 CONSTANT
(properties
(name "Short Timeout"))
(interface
(output 1
(name "Real64")
(lock name constraints)))
(implementation
(value Real
(data  2))
(initValue Real
(data  0))))
(device 39 IFTHENELSE
(properties
(cases 2 "(A==1 OR A==2) AND (B==1 OR B==2)" "(A==0) OR (B==0)"))
(interface
(input 1
(name "A")
(optional yes))
(input 2
(name "B")
(optional yes))
(output 1
(name "Then")
(lock name constraints))
(output 2
(name "Else If")
(lock name constraints))
(output 3
(name "Else")
(lock name constraints))))
(device 40 MESSAGEBOX
(properties
(timeout 5)
(position 201 201)
(message "ECal is not connected to ports 1 and 2.  The program will stop.")
(symbol Stop))
(interface
(output 1
(name "OK")
(lock name constraints)))
(implementation
(customButtons 0)
(displayMode 3)
(buttons "OK")
(buttonLabel1 "OK")
(buttonLabel2 "")
(buttonLabel3 "")
(bdefault "OK")))
(device 41 EXITPROCESS
(properties
(code 0)))
(device 42 EXITCONTEXT)
(device 43 MESSAGEBOX
(properties
(timeout 5)
(position 201 201)
(message "ECAL is connecte.  The program will stop.")
(symbol Stop))
(interface
(input 1
(name "Message")
(tag "Message")
(requires
(datatype Text))
(lock name constraints)
(optional yes)
(buffer YES))
(output 1
(name "OK")
(lock name constraints)))
(implementation
(customButtons 0)
(displayMode 3)
(buttons "OK")
(buttonLabel1 "OK")
(buttonLabel2 "")
(buttonLabel3 "")
(bdefault "OK")))
(device 44 FORMULA
(properties
(expr 1 "\"Ecal is connected to ports \" +A+\" and \" + B"))
(interface
(input 1
(name "A")
(optional yes))
(input 2
(name "B")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 45 EXITPROCESS
(properties
(code 0)))
(configuration
(connect D4:0 D0:0)
(connect D4:1 D0:1)
(connect D2:0 D1:0)
(connect D0:3 D2:0)
(connect D0:1 D5:1)
(connect D0:2 D5:2)
(connect D5:2 D6:0)
(connect D6:0 D7:0)
(connect D5:1 D8:0)
(connect D5:3 D9:0)
(connect D10:1 D9:1)
(connect D0:1 D10:1)
(connect D0:2 D10:2)
(connect D9:0 D11:0)))
(contextCarrier
(active detail)
(detail
(extent 350 300)
(anchorPt -188 51)
(configuration
(devCarrierFor 3
(active open)
(icon
(extent 140 51)
(iconImage "io.icn"))
(open
(extent 364 106))
(terminals on)
(pinCenter 440 280))
(devCarrierFor 25
(active icon)
(icon
(extent 68 51)
(iconImage "stop.icn"))
(open
(extent 65 31))
(pinCenter 630 460))
(devCarrierFor 26
(active icon)
(icon
(extent 92 34))
(open
(extent 484 126))
(terminals on)
(pinCenter 630 380))
(devCarrierFor 33
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 504 66)
(editing enabled))
(pinCenter 920 170))
(devCarrierFor 12
(active open)
(icon
(extent 84 15))
(open
(extent 120 29)
(showFormat real))
(pinCenter 430 130))
(devCarrierFor 39
(active open)
(icon)
(open
(extent 241 62))
(terminals on)
(pinCenter 920 280))
(devCarrierFor 40
(active icon)
(icon
(extent 92 34))
(open
(extent 484 126))
(terminals on)
(pinCenter 1090 380))
(devCarrierFor 41
(active icon)
(icon
(extent 68 51)
(iconImage "stop.icn"))
(open
(extent 65 31))
(pinCenter 1090 470))
(devCarrierFor 42
(active icon)
(icon
(extent 92 15))
(open)
(terminals on)
(pinCenter 1210 270))
(devCarrierFor 43
(active icon)
(icon
(extent 92 34))
(open
(extent 484 126))
(terminals on)
(pinCenter 1250 370))
(devCarrierFor 44
(active icon)
(icon
(extent 50 25))
(open
(extent 145 50))
(terminals on)
(pinCenter 850 390))
(devCarrierFor 45
(active icon)
(icon
(extent 68 51)
(iconImage "stop.icn"))
(open
(extent 65 31))
(pinCenter 1250 470))
(connect D4:0 D0:0
(points 2 430 147 430 206))
(connect D4:1 D0:1
(points 6 492 130 510 130 510 170 180 170 180 280 195 280))
(connect D2:0 D1:0
(points 2 630 399 630 432))
(connect D0:3 D2:0
(points 5 664 310 680 310 680 350 630 350 630 360))
(connect D0:1 D5:1
(points 4 664 250 710 250 710 260 767 260))
(connect D0:2 D5:2
(points 4 664 280 700 280 700 300 767 300))
(connect D5:2 D6:0
(points 5 1093 280 1110 280 1110 330 1090 330 1090 360))
(connect D6:0 D7:0
(points 2 1090 399 1090 442))
(connect D5:1 D8:0
(points 5 1093 260 1110 260 1110 240 1210 240 1210 260))
(connect D5:3 D9:0
(points 3 1093 300 1250 300 1250 350))
(connect D10:1 D9:1
(points 6 877 390 900 390 900 420 1160 420 1160 370 1201 370))
(connect D0:1 D10:1
(points 4 664 250 710 250 710 380 822 380))
(connect D0:2 D10:2
(points 4 664 280 700 280 700 400 822 400))
(connect D9:0 D11:0
(points 2 1250 389 1250 442)))
(stackingOrder 3 5 1 2 8 6 10 9 7 11 4 0))))
(device 142 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Get Ecal information and use it to set the cal frequency limits\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 146 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 1 "WRITE TEXT \"SENS\"+chan+\":CORR:STATE OFF\" EOL"))
(interface
(input 1
(name "chan")
(optional yes)))
(implementation
(iopath "VNA")))
(device 147 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Now we turn correction off for the channel, so that we can get the raw data\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 149 TOGLOBAL
(properties
(name "Set RawData")
(globalName "RawData"))
(interface
(input 1
(name "Data")
(tag "Data"))))
(device 152 CONTEXT
(properties
(name "Driving Data")
(trigMode deg)
(nextID 14)
(popupTitleText "UserObject")
(popupMoveable 1))
(interface
(output 1
(type data)
(name "StartFreq")
(lock constraints)
(optional yes))
(output 2
(type data)
(name "StopFreq")
(lock constraints)
(optional yes))
(output 3
(type data)
(name "Points")
(lock constraints)
(optional yes))
(output 4
(type data)
(name "IFBw")
(lock constraints)
(optional yes))
(output 5
(type data)
(name "ChanNo")
(lock constraints)
(optional yes))
(output 6
(type data)
(name "ParameterList")
(lock constraints)
(optional yes)))
(deviceList
(device 0 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Courier New;}}\r\n\\viewkind4\\uc1\\pard\\f0\\fs18 All these parameters will be\\par\r\nset-up in the Network Analyzer.  We place them all on the panel view of the user object\\par\r\n\\par\r\n}\r\n"
)))
(device 1 LITERALCONSTANT
(properties
(name "Parameters to Measure"))
(interface
(output 1
(name "Text")
(lock name constraints)))
(implementation
(value Text
(numDims 1)
(size 4)
(data  [ "S11" "S21" "S12" "S22" ]))
(initValue Text
(data  ""))))
(device 2 CONSTANT
(properties
(name "Start Freq (Hz)"))
(interface
(output 1
(name "Real64")
(lock name constraints)))
(implementation
(value Real
(data  50000000))
(initValue Real
(data  0))))
(device 3 CONSTANT
(properties
(name "Stop Freq (Hz)"))
(interface
(output 1
(name "Real64")
(lock name constraints)))
(implementation
(value Real
(data  800000000))
(initValue Real
(data  0))))
(device 5 CONSTANT
(properties
(name "IF BW (Hz)"))
(interface
(output 1
(name "Real64")
(lock name constraints)))
(implementation
(value Real
(data  1000))
(initValue Real
(data  0))))
(device 6 TOGLOBAL
(properties
(name "Set Params")
(globalName "Params"))
(interface
(input 1
(name "Data")
(tag "Data"))))
(device 7 ENUMCONSTANT
(properties
(name "Channel"))
(interface
(input 1
(type control)
(name "Enum Values")
(lock name constraints)
(optional yes))
(output 1
(name "Enum")
(lock name constraints))
(output 2
(name "Ordinal")
(lock name constraints)))
(implementation
(value Enum
(values
("Channel 1" 0)
("Channel 2" 1)
("Channel 3" 2)
("Channel 4" 3)
("Channel 5" 4)
("Channel 6" 5)
("Channel 7" 6)
("Channel 8" 7)
("Channel 9" 8)
("Channel 10" 9)
("Channel 11" 10)
("Channel 12" 11)
("Channel 13" 12)
("Channel 14" 13)
("Channel 15" 14)
("Channel 16" 15)
("Channel 17" 16)
("Channel 18" 17)
("Channel 19" 18)
("Channel 20" 19)
("Channel 21" 20)
("Channel 22" 21)
("Channel 23" 22)
("Channel 24" 23)
("Channel 25" 24)
("Channel 26" 25)
("Channel 27" 26)
("Channel 28" 27)
("Channel 29" 28)
("Channel 30" 29)
("Channel 31" 30)
("Channel 32" 31))
(data  "Channel 1"))
(initValue Text
(data  "Channel 1"))))
(device 8 FORMULA
(properties
(name "convert ordinal to chan. no.")
(expr 1 "A + 1"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 9 CONSTANT
(properties
(name "PNA Max Channel"))
(interface
(output 1
(name "Int32")
(lock name constraints)))
(implementation
(value Int32
(data  32))
(initValue Int32
(data  0))))
(device 10 FORMULA
(properties
(name "build channel list")
(expr 1 "\"Channel \" + asText(ramp(A,1,A))"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 12 CONSTANT
(properties
(name "Points"))
(interface
(output 1
(name "Int32")
(lock name constraints)))
(implementation
(value Int32
(data  401))
(initValue Int32
(data  0))))
(device 13 LABEL
(properties
(name "Measurement Setup Information")
(labelValue "Measurement Setup Information"))
(implementation))
(configuration
(connect D1:1 D5:1)
(connect D9:0 D6:0)
(connect D9:1 D6:1)
(connect D6:2 D7:1)
(connect D8:1 D9:1)
(connect D2:1 O1:1)
(connect D3:1 O2:1)
(connect D10:1 O3:1)
(connect D4:1 O4:1)
(connect D7:1 O5:1)
(connect D1:1 O6:1)))
(contextCarrier
(active detail)
(panel
(extent 443 210)
(drawGrid "on")
(widget 2 detail
(relativeOrigin 0 90)
(PID 0)
(title on)
(tabIndex 0)
(borderStyle flat)
(extent 121 29)
(showFormat real))
(widget 3 detail
(relativeOrigin 130 90)
(PID 1)
(title on)
(tabIndex 1)
(borderStyle flat)
(extent 121 29)
(showFormat real))
(widget 10 detail
(relativeOrigin 0 150)
(PID 2)
(title on)
(tabIndex 2)
(borderStyle flat)
(extent 121 29)
(showFormat int))
(widget 4 detail
(relativeOrigin 130 150)
(PID 3)
(title on)
(tabIndex 3)
(borderStyle flat)
(extent 121 29)
(showFormat real))
(widget 6 detail
(relativeOrigin 0 30)
(PID 4)
(title on)
(tabIndex 4)
(borderStyle flat)
(extent 121 29)
(format dropDown))
(widget 1 detail
(relativeOrigin 260 30)
(PID 5)
(title on)
(tabIndex 5)
(borderStyle flat)
(extent 166 148))
(widget 11 detail
(relativeOrigin -10 0)
(PID 6)
(title off)
(tabStop off)
(tabIndex 6)
(borderStyle none)
(extent 400 30)
(just c)))
(detail
(extent 628 718)
(anchorPt 0 -1)
(configuration
(devCarrierFor 0
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 222 102)
(editing enabled))
(pinCenter 170 210))
(devCarrierFor 1
(active open)
(icon
(extent 141 0))
(open
(extent 195 237))
(pinCenter 180 440))
(devCarrierFor 2
(active open)
(icon
(extent 85 0))
(open
(extent 121 29)
(showFormat real))
(pinCenter 430 100))
(devCarrierFor 3
(active open)
(icon
(extent 85 0))
(open
(extent 121 29)
(showFormat real))
(pinCenter 430 160))
(devCarrierFor 5
(active open)
(icon
(extent 62 0))
(open
(extent 121 29)
(showFormat real))
(pinCenter 430 280))
(devCarrierFor 6
(active open)
(icon
(extent 71 0))
(open
(extent 73 51))
(terminals on)
(pinCenter 425 550))
(devCarrierFor 7
(active open)
(icon
(extent 51 25))
(open
(extent 130 25)
(format dropDown))
(pinCenter 450 380))
(devCarrierFor 8
(active icon)
(icon
(extent 160 15))
(open
(extent 145 50))
(terminals on)
(pinCenter 480 450))
(devCarrierFor 9
(active open)
(icon
(extent 107 0))
(open
(extent 143 29)
(showFormat int))
(pinCenter 160 610))
(devCarrierFor 10
(active icon)
(icon
(extent 102 15))
(open
(extent 254 186))
(terminals on)
(pinCenter 160 650))
(devCarrierFor 12
(active open)
(icon
(extent 39 0))
(open
(extent 104 26)
(showFormat int))
(pinCenter 430 220))
(devCarrierFor 13
(active open)
(icon
(extent 193 0))
(open
(extent 254 34)
(just c))
(title off)
(bg "Control")
(pinCenter 180 80))
(connect D1:1 D5:1
(points 4 280 440 300 440 300 550 346 550))
(connect D9:0 D6:0
(points 6 160 660 160 690 320 690 320 320 450 320 450 347))
(connect D9:1 D6:1
(points 6 213 650 290 650 290 540 310 540 310 380 382 380))
(connect D6:2 D7:1
(points 6 517 390 540 390 540 420 380 420 380 450 397 450))
(connect D8:1 D9:1
(points 6 234 610 250 610 250 680 90 680 90 650 106 650))
(connect D2:1 O1:1
(points 4 493 100 510 100 510 59 627 59))
(connect D3:1 O2:1
(points 4 493 160 510 160 510 179 627 179))
(connect D10:1 O3:1
(points 4 484 220 520 220 520 299 627 299))
(connect D4:1 O4:1
(points 6 493 280 510 280 510 290 550 290 550 419 627 419))
(connect D7:1 O5:1
(points 6 562 450 580 450 580 940 1680 940 1680 539 627 539))
(connect D1:1 O6:1
(points 4 280 440 300 440 300 659 627 659)))
(stackingOrder 0 1 3 5 8 9 10 4 7 6 11 2))))
(device 154 CONTEXT
(properties
(name "(1) SetUpNewTraces")
(trigMode deg)
(nextID 148)
(popupTitleText "UserObject")
(popupMoveable 1))
(interface
(input 1
(name "Chan")
(optional yes))
(input 2
(name "Params")
(optional yes)))
(deviceList
(device 84 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 First, send the command \"SYST:PRES\", which does a preset and deletes the default trace, but then you lose any settings like calibration, power, etc.  We set the the data form to 32 bit real (the VNA doesn\'t have more resolution than that).  This can be done anytime before you read data.  Then we hold the analyzer, so we don\'t have to compete with data taking.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 126 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Set up the ENA traces by setting the number of displayed traces.  You have to set the \"disp:spl\" command to display a channel other than chan 1 (default).  Then we\'ll make the desired channel maximum.  Note: on the ENA you must turn on all channels less than the desired channel, thus usually use chan 1.  You can skip the first three commands if you use chan 1\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 127 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 You need to find out how many channels and traces the ENA is set to.  It can be set to 4 & 16, 9 & 9, 12 & 6 or 16 & 4.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 130 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 1 "WRITE TEXT \"calc\"+chan+\":par\"+(i+1)+\":def \"+Param[i] EOL"
))
(interface
(input 1
(name "chan")
(optional yes))
(input 2
(name "i")
(optional yes))
(input 3
(name "Param")
(optional yes)))
(implementation
(iopath "VNA")))
(device 131 FORCOUNT
(properties
(count 4))
(interface
(input 1
(name "Count")
(tag "Count")
(requires
(datatype Int32)
(shape "Scalar"))
(lock constraints)
(optional yes)
(buffer YES))
(output 1
(name "Count")
(lock name constraints))))
(device 132 JUNCTION
(properties
(name "JCT"))
(interface
(input 1
(name "A"))
(input 2
(name "B"))
(output 1
(name "Data"))))
(device 133 FORMULA
(properties
(name "Max trace")
(expr 1 "\"Maximum Number of Parameters is \"+A"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 134 IFTHENELSE
(properties
(cases 1 "A<B"))
(interface
(input 1
(name "B")
(optional yes))
(input 2
(name "A")
(optional yes))
(output 1
(name "Then")
(lock name constraints))
(output 2
(name "Else")
(lock name constraints))))
(device 135 FORMULA
(properties
(name "size")
(expr 1 "totsize(a)"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 136 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 5 "WRITE TEXT \"disp:spl \"+A[chan-1] EOL"
"WRITE TEXT \"disp:wind\"+chan+\":act\" EOL" "WRITE TEXT \"Disp:max on\" EOL"
"WRITE TEXT \"calc\"+chan+\":par:coun \"+trace EOL"
"WRITE TEXT \"init\"+chan+\":cont off\" EOL"))
(interface
(input 1
(name "A")
(optional yes))
(input 2
(name "chan")
(optional yes))
(input 3
(name "trace")
(optional yes)))
(implementation
(iopath "VNA")))
(device 137 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 4 "WRITE TEXT \"serv:chan:count?\" EOL" "READ TEXT chans REAL64"
"WRITE TEXT \"serv:chan:trac:coun?\" EOL" "READ TEXT traces REAL64"))
(interface
(output 1
(name "chans")
(optional yes))
(output 2
(name "traces")
(optional yes)))
(implementation
(iopath "VNA")))
(device 138 EXITPROCESS
(properties
(code 0)))
(device 139 FORMULA
(properties
(name "max channel is")
(expr 1 "\"Maximum Channel is \"+A"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 140 MESSAGEBOX
(properties
(message "User Message")
(symbol Information))
(interface
(input 1
(name "Message")
(tag "Message")
(requires
(datatype Text))
(lock name constraints)
(optional yes)
(buffer YES))
(output 1
(name "OK")
(lock name constraints)))
(implementation
(customButtons 0)
(displayMode 3)
(buttons "OK")
(buttonLabel1 "OK")
(buttonLabel2 "")
(buttonLabel3 "")
(bdefault "OK")))
(device 141 IFTHENELSE
(properties
(cases 1 "A<B"))
(interface
(input 1
(name "B")
(optional yes))
(input 2
(name "A")
(optional yes))
(output 1
(name "Then")
(lock name constraints))
(output 2
(name "Else")
(lock name constraints))))
(device 142 LITERALCONSTANT
(properties
(name "SetupChannel"))
(interface
(output 1
(name "Text")
(lock name constraints)))
(implementation
(value Text
(numDims 1)
(size 16)
(data  [ "D1" "D12" "D123" "D12_34" "D12_34_56" "D12_34_56" "D12_34_56_78"
"D12_34_56_78" "D123_456_789" "D123_ABC" "D123_ABC" "D123_ABC" "D1234_CDEF"
"D1234_CDEF" "D1234_CDEF" "D1234_CDEF" ]))
(initValue Text
(data  ""))))
(device 145 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 2 "WRITE TEXT \"syst:pres\" EOL"
"WRITE TEXT \":Form:data REAL32\" EOL"))
(interface
(output 1
(name "chans")
(optional yes))
(output 2
(name "traces")
(optional yes)))
(implementation
(iopath "VNA")))
(device 146 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Pop a message if there are more requested parameters than allowed traces, or if the channel number exceeds the max. channel.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 147 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Loop through the number of parameters and set a trace to each desired parameter\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(configuration
(connect I1:1 D3:1)
(connect D4:1 D3:2)
(connect I2:1 D3:3)
(connect D8:1 D4:1)
(connect D12:1 D5:1)
(connect D6:1 D5:2)
(connect D7:1 D6:0)
(connect D10:2 D6:1)
(connect D14:2 D7:0)
(connect D8:1 D7:1)
(connect D10:2 D7:2)
(connect I2:1 D8:1)
(connect D7:2 D9:0)
(connect D15:1 D9:1)
(connect I1:1 D9:2)
(connect D8:1 D9:3)
(connect D13:1 D11:0)
(connect D14:1 D12:0)
(connect D10:1 D12:1)
(connect D5:1 D13:1)
(connect D16:0 D14:0)
(connect I1:1 D14:1)
(connect D10:1 D14:2)
(connect D10:1 D16:0)))
(contextCarrier
(active detail)
(detail
(extent 1372 818)
(anchorPt -4 -366)
(configuration
(devCarrierFor 84
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 444 226)
(editing enabled))
(pinCenter 970 370))
(devCarrierFor 126
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 414 206)
(editing enabled))
(pinCenter 1000 1020))
(devCarrierFor 127
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter 240 260))
(devCarrierFor 130
(active open)
(icon
(extent 80 51)
(iconImage "io.icn"))
(open
(extent 335 117))
(terminals on)
(pinCenter 680 1280))
(devCarrierFor 131
(active open)
(icon
(iconImage "loop.icn"))
(open
(extent 95 31))
(pinCenter 330 1220))
(devCarrierFor 132
(active icon)
(icon
(extent 26 25))
(open)
(terminals on)
(pinCenter 570 780))
(devCarrierFor 133
(active icon)
(icon
(extent 56 15))
(open
(extent 194 56))
(terminals on)
(pinCenter 460 910))
(devCarrierFor 134
(active open)
(icon)
(open
(extent 55 51))
(terminals on)
(pinCenter 455 840))
(devCarrierFor 135
(active open)
(icon
(extent 26 0))
(open
(extent 145 50))
(terminals on)
(pinCenter 180 850))
(devCarrierFor 136
(active open)
(icon
(extent 80 51)
(iconImage "io.icn"))
(open
(extent 335 117))
(terminals on)
(pinCenter 575 1030))
(devCarrierFor 137
(active open)
(icon
(extent 80 0)
(iconImage "io.icn"))
(open
(extent 224 134))
(terminals on)
(pinCenter 170 460))
(devCarrierFor 138
(active open)
(icon
(iconImage "stop.icn"))
(open
(extent 65 31))
(pinCenter 870 830))
(devCarrierFor 139
(active icon)
(icon
(extent 91 15))
(open
(extent 194 56))
(terminals on)
(pinCenter 470 730))
(devCarrierFor 140
(active open)
(icon)
(open
(extent 219 126))
(terminals on)
(pinCenter 750 680))
(devCarrierFor 141
(active open)
(icon)
(open
(extent 55 51))
(terminals on)
(pinCenter 465 630))
(devCarrierFor 142
(active icon)
(icon
(extent 86 15))
(open
(extent 237 164))
(pinCenter 240 990))
(devCarrierFor 145
(active open)
(icon
(extent 80 0)
(iconImage "io.icn"))
(open
(extent 224 134))
(terminals on)
(pinCenter 540 460))
(devCarrierFor 146
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter 1130 680))
(devCarrierFor 147
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 294 86)
(editing enabled))
(pinCenter 1050 1280))
(connect I1:1 D3:1
(points 8 4 564 -20 564 -20 620 350 620 350 1110 410 1110 410 1240 460 1240))
(connect D4:1 D3:2
(points 4 380 1220 400 1220 400 1280 460 1280))
(connect I2:1 D3:3
(points 4 4 984 -20 984 -20 1320 460 1320))
(connect D8:1 D4:1
(points 6 305 850 340 850 340 1070 260 1070 260 1220 280 1220))
(connect D12:1 D5:1
(points 4 518 730 540 730 540 770 554 770))
(connect D6:1 D5:2
(points 8 490 910 570 910 570 820 560 820 560 800 540 800 540 790 554 790))
(connect D7:1 D6:0
(points 5 525 830 550 830 550 890 460 890 460 900))
(connect D10:2 D6:1
(points 6 334 500 360 500 360 850 380 850 380 910 429 910))
(connect D14:2 D7:0
(points 9 535 640 550 640 550 670 540 670 540 720 530 720 530 760 460 760 460
794))
(connect D8:1 D7:1
(points 4 305 850 330 850 330 830 395 830))
(connect D10:2 D7:2
(points 4 334 500 360 500 360 850 395 850))
(connect I2:1 D8:1
(points 4 4 984 -20 984 -20 850 75 850))
(connect D7:2 D9:0
(points 5 525 850 560 850 560 920 570 920 570 951))
(connect D15:1 D9:1
(points 2 285 990 365 990))
(connect I1:1 D9:2
(points 6 4 564 -20 564 -20 620 350 620 350 1030 365 1030))
(connect D8:1 D9:3
(points 4 305 850 340 850 340 1070 365 1070))
(connect D13:1 D11:0
(points 5 892 680 910 680 910 770 870 770 870 794))
(connect D14:1 D12:0
(points 7 535 620 560 620 560 660 530 660 530 680 470 680 470 720))
(connect D10:1 D12:1
(points 6 334 420 370 420 370 640 390 640 390 730 422 730))
(connect D5:1 D13:1
(points 6 585 780 600 780 600 760 550 760 550 680 568 680))
(connect D16:0 D14:0
(points 4 550 529 550 550 470 550 470 584))
(connect I1:1 D14:1
(points 4 4 564 -20 564 -20 620 405 620))
(connect D10:1 D14:2
(points 4 334 420 370 420 370 640 405 640))
(connect D10:1 D16:0
(points 5 334 420 370 420 370 350 550 350 550 372)))
(stackingOrder 3 4 5 6 7 8 9 11 12 13 14 10 16 0 2 17 18 15 1))))
(device 156 CONTEXT
(properties
(name "(2) SetUp Channel")
(trigMode deg)
(nextID 4)
(popupTitleText "UserObject")
(popupMoveable 1))
(interface
(input 1
(name "Fstart")
(optional yes))
(input 2
(name "Fstop")
(optional yes))
(input 3
(name "Points")
(optional yes))
(input 4
(name "IFBW")
(optional yes))
(input 5
(name "Chan")
(optional yes)))
(deviceList
(device 1 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Setting up the channel is easy.  Just send that start, stop frequencies, the number of points, and the IF bandwidth.  You could also set the power, choose a calibration Calset, and do many other setup functions here.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 3 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 4 "WRITE TEXT \"sens\"+chan+\":freq:star \"+Fstart EOL"
"WRITE TEXT \"sens\"+chan+\":freq:stop \"+Fstop EOL"
"WRITE TEXT \"sens\"+chan+\":swe:poin \"+Points EOL"
"WRITE TEXT \"sens\"+chan+\":bwid \"+IFBw EOL"))
(interface
(input 1
(name "Fstart")
(optional yes))
(input 2
(name "Fstop")
(optional yes))
(input 3
(name "Points")
(optional yes))
(input 4
(name "IFBw")
(optional yes))
(input 5
(name "Chan")
(optional yes)))
(implementation
(iopath "VNA")))
(configuration
(connect I1:1 D1:1)
(connect I2:1 D1:2)
(connect I3:1 D1:3)
(connect I4:1 D1:4)
(connect I5:1 D1:5)))
(contextCarrier
(active detail)
(detail
(extent 400 383)
(anchorPt 24 -93)
(configuration
(devCarrierFor 1
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 434 136)
(editing enabled))
(pinCenter 320 350))
(devCarrierFor 3
(active open)
(icon
(extent 157 0)
(iconImage "io.icn"))
(open
(extent 229 122))
(terminals on)
(pinCenter 270 570))
(connect I1:1 D1:1
(points 4 -24 144 10 144 10 530 103 530))
(connect I2:1 D1:2
(points 4 -24 214 0 214 0 550 103 550))
(connect I3:1 D1:3
(points 4 -24 284 -10 284 -10 570 103 570))
(connect I4:1 D1:4
(points 4 -24 354 0 354 0 590 103 590))
(connect I5:1 D1:5
(points 4 -24 424 -10 424 -10 610 103 610)))
(stackingOrder 0 1))))
(device 159 CONTEXT
(properties
(name "(4a) GetFreqList")
(trigMode deg)
(nextID 39)
(popupTitleText "UserObject")
(popupMoveable 1))
(interface
(input 1
(name "chan")
(requires
(datatype Text))
(optional yes))
(output 1
(type data)
(name "Type")
(lock constraints)
(optional yes))
(output 2
(type data)
(name "Freq")
(lock constraints)
(optional yes)))
(deviceList
(device 0 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 2 "WRITE TEXT \"sens\"+chan+\":swe:type?;\" EOL" "READ TEXT x STR"
))
(interface
(input 1
(name "chan")
(requires
(datatype Text))
(optional yes))
(output 1
(name "x")
(optional yes)))
(implementation
(iopath "VNA")))
(device 1 IFTHENELSE
(properties
(cases 3 "a==\"SEGM\"" "a==\"LIN\"" "a==\"LOG\""))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Then")
(lock name constraints))
(output 2
(name "Else If")
(lock name constraints))
(output 3
(name "Else If")
(lock name constraints))
(output 4
(name "Else")
(lock name constraints))))
(device 3 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 6 "WRITE TEXT \"sens\"+chan+\":swe:poin?;\" EOL"
"READ TEXT points INT16" "WRITE TEXT \"sens\"+chan+\":freq:star?;\" EOL"
"READ TEXT star REAL64" "WRITE TEXT \"sens\"+chan+\":freq:stop?;\" EOL"
"READ TEXT stop REAL64"))
(interface
(input 1
(name "chan")
(requires
(datatype Text))
(optional yes))
(output 1
(name "points")
(optional yes))
(output 2
(name "star")
(optional yes))
(output 3
(name "stop")
(optional yes)))
(implementation
(iopath "VNA")))
(device 4 TEXTDISPLAY
(properties
(name "Sweep type"))
(interface
(input 1
(name "Data"))))
(device 5 FORMULA
(properties
(name "ramp(numElem,start,stop)")
(expr 1 "round(ramp(numElem,start,stop))"))
(interface
(input 1
(name "numElem")
(optional yes))
(input 2
(name "start")
(optional yes))
(input 3
(name "stop")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 6 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 6 "WRITE TEXT \"sens\"+chan+\":swe:poin?;\" EOL"
"READ TEXT points INT16" "WRITE TEXT \"sens\"+chan+\":freq:star?;\" EOL"
"READ TEXT star REAL64" "WRITE TEXT \"sens\"+chan+\":freq:stop?;\" EOL"
"READ TEXT stop REAL64"))
(interface
(input 1
(name "chan")
(requires
(datatype Text))
(optional yes))
(output 1
(name "points")
(optional yes))
(output 2
(name "star")
(optional yes))
(output 3
(name "stop")
(optional yes)))
(implementation
(iopath "VNA")))
(device 7 MESSAGEBOX
(properties
(name "Not Lin, log or seg")
(message "Sweep Type Must be LIN, LOG, or SEGMENT.")
(symbol Information))
(interface
(output 1
(name "OK")
(lock name constraints)))
(implementation
(customButtons 0)
(displayMode 3)
(buttons "OK")
(buttonLabel1 "OK")
(buttonLabel2 "")
(buttonLabel3 "")
(bdefault "OK")))
(device 8 FORMULA
(properties
(name "ramp(numElem,start,stop)")
(expr 1 "round(logramp(numElem,start,stop))"))
(interface
(input 1
(name "numElem")
(optional yes))
(input 2
(name "start")
(optional yes))
(input 3
(name "stop")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 11 EXITPROCESS
(properties
(code 0)))
(device 13 JUNCTION
(properties
(name "JCT"))
(interface
(input 1
(name "C")
(optional yes))
(input 2
(name "A")
(optional yes))
(input 3
(name "B")
(optional yes))
(output 1
(name "Data"))))
(device 28 COLLECTOR
(interface
(input 1
(name "Data")
(tag "Data"))
(input 2
(type trigger)
(name "XEQ")
(lock name constraints))
(output 1
(name "Array")
(tag "Array"))))
(device 32 FORMULA
(properties
(name "ramp(numElem,start,stop)")
(expr 1 "round(ramp(numElem,start,stop))"))
(interface
(input 1
(name "numElem")
(optional yes))
(input 2
(name "start")
(optional yes))
(input 3
(name "stop")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 31 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 6 "WRITE TEXT \"sens\"+chan+\":segm\"+segm+\":swe:poin?;\" EOL"
"READ TEXT points INT16"
"WRITE TEXT \"sens\"+chan+\":segm\"+segm+\":freq:star?;\" EOL"
"READ TEXT star REAL64"
"WRITE TEXT \"sens\"+chan+\":segm\"+segm+\":freq:stop?;\" EOL"
"READ TEXT stop REAL64"))
(interface
(input 1
(name "chan")
(requires
(datatype Text))
(optional yes))
(input 2
(name "segm")
(optional yes))
(output 1
(name "points")
(optional yes))
(output 2
(name "star")
(optional yes))
(output 3
(name "stop")
(optional yes)))
(implementation
(iopath "VNA")))
(device 27 FORMULA
(properties
(name "a+1")
(expr 1 "a+1"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 26 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 2 "WRITE TEXT \"sens\"+chan+\":segm:coun?;\" EOL"
"READ TEXT x INT16"))
(interface
(input 1
(name "chan")
(requires
(datatype Text))
(optional yes))
(output 1
(name "x")
(optional yes)))
(implementation
(iopath "VNA")))
(device 25 FORCOUNT
(properties
(count 1))
(interface
(input 1
(name "Count")
(tag "Count")
(requires
(datatype Int32)
(shape "Scalar"))
(lock constraints)
(optional yes)
(buffer YES))
(output 1
(name "Count")
(lock name constraints))))
(device 34 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 First, find out the sweep type\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 35 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 If it\'s a segment sweep, loop through each segment and get the start, stop and points, then collect them all into one array.  Theres a maximum of 8000 segments, so we can read this into an integer.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 36 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 If it\'s a log or lin sweep, get the start, stop and points.  For a lin sweep create a ramp array, if it\'s a log sweep, creat a log ramp array of frequencies. Be sure to use 64 bit reals to read frequencies.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 37 NOTE
(properties
(name "Why do we need to do this?")
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Sorry, there\'s no way in SCPI to get the frequency list directly, so we need to create it from stimulus values\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 38 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 If it\'s not a lin, log or seg sweep, just stop\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(configuration
(connect I1:1 D0:1)
(connect D0:1 D1:1)
(connect D1:2 D2:0)
(connect I1:1 D2:1)
(connect D0:1 D3:1)
(connect D2:1 D4:1)
(connect D2:2 D4:2)
(connect D2:3 D4:3)
(connect D1:3 D5:0)
(connect I1:1 D5:1)
(connect D1:4 D6:0)
(connect D5:1 D7:1)
(connect D5:2 D7:2)
(connect D5:3 D7:3)
(connect D6:1 D8:0)
(connect D10:1 D9:1)
(connect D4:1 D9:2)
(connect D7:1 D9:3)
(connect D11:1 D10:1)
(connect D15:0 D10:2)
(connect D12:1 D11:1)
(connect D12:2 D11:2)
(connect D12:3 D11:3)
(connect I1:1 D12:1)
(connect D13:1 D12:2)
(connect D15:1 D13:1)
(connect D1:1 D14:0)
(connect I1:1 D14:1)
(connect D14:1 D15:0)
(connect D14:1 D15:1)
(connect D0:1 O1:1)
(connect D9:1 O2:1)))
(contextCarrier
(active detail)
(detail
(extent 648 907)
(anchorPt 289 -111)
(configuration
(devCarrierFor 0
(active open)
(icon
(extent 80 51)
(iconImage "io.icn"))
(open
(extent 354 66))
(terminals on)
(pinCenter 215 100))
(devCarrierFor 1
(active open)
(icon)
(open
(extent 119 82))
(terminals on)
(pinCenter 160 240))
(devCarrierFor 3
(active open)
(icon
(extent 80 51)
(iconImage "io.icn"))
(open
(extent 385 107))
(terminals on)
(pinCenter 135 720))
(devCarrierFor 4
(active open)
(icon
(extent 69 0))
(open
(extent 121 22))
(pinCenter 550 70))
(devCarrierFor 5
(active open)
(icon
(extent 159 34))
(open
(extent 176 70))
(terminals on)
(pinCenter 560 730))
(devCarrierFor 6
(active open)
(icon
(extent 80 51)
(iconImage "io.icn"))
(open
(extent 385 107))
(terminals on)
(pinCenter 145 890))
(devCarrierFor 7
(active icon)
(icon
(extent 110 15))
(open
(extent 219 126))
(terminals on)
(pinCenter 520 280))
(devCarrierFor 8
(active open)
(icon
(extent 159 34))
(open
(extent 176 70))
(terminals on)
(pinCenter 580 880))
(devCarrierFor 11
(active open)
(icon
(iconImage "stop.icn"))
(open
(extent 65 31))
(pinCenter 680 320))
(devCarrierFor 13
(active open)
(icon
(extent 26 34))
(open
(extent 12 70))
(terminals on)
(pinCenter 775 730))
(devCarrierFor 28
(active icon)
(icon
(extent 53 25))
(open
(extent 96 54))
(terminals on)
(pinCenter 1160 510))
(devCarrierFor 32
(active open)
(icon
(extent 159 34))
(open
(extent 176 70))
(terminals on)
(pinCenter 960 520))
(devCarrierFor 31
(active open)
(icon
(extent 80 51)
(iconImage "io.icn"))
(open
(extent 385 107))
(terminals on)
(pinCenter 530 520))
(devCarrierFor 27
(active icon)
(icon
(extent 25 15))
(open
(extent 71 50))
(terminals on)
(pinCenter 250 530))
(devCarrierFor 26
(active open)
(icon
(extent 80 51)
(iconImage "io.icn"))
(open
(extent 364 56))
(terminals on)
(pinCenter 165 380))
(devCarrierFor 25
(active open)
(icon
(iconImage "loop.icn"))
(open
(extent 95 31))
(pinCenter 550 380))
(devCarrierFor 34
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 264 56)
(editing enabled))
(pinCenter -220 100))
(devCarrierFor 35
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 314 156)
(editing enabled))
(pinCenter -250 330))
(devCarrierFor 36
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 314 186)
(editing enabled))
(pinCenter -300 710))
(devCarrierFor 37
(active open)
(icon
(extent 165 0)
(iconImage "notepad.icn"))
(open
(extent 404 116)
(editing enabled))
(pinCenter 100 -50))
(devCarrierFor 38
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 194 76)
(editing enabled))
(pinCenter 660 210))
(connect I1:1 D0:1
(points 6 -289 564 -60 564 -60 430 -70 430 -70 100 -5 100))
(connect D0:1 D1:1
(points 6 424 100 440 100 440 160 50 160 50 240 68 240))
(connect D1:2 D2:0
(points 5 272 230 410 230 410 440 140 440 140 646))
(connect I1:1 D2:1
(points 4 -289 564 -190 564 -190 720 -100 720))
(connect D0:1 D3:1
(points 4 424 100 450 100 450 70 487 70))
(connect D2:1 D4:1
(points 4 380 690 390 690 390 710 399 710))
(connect D2:2 D4:2
(points 4 380 720 390 720 390 730 399 730))
(connect D2:3 D4:3
(points 2 380 750 399 750))
(connect D1:3 D5:0
(points 11 272 250 400 250 400 430 270 430 270 500 -120 500 -120 710 -110 710
-110 800 150 800 150 816))
(connect I1:1 D5:1
(points 6 -289 564 -190 564 -190 720 -120 720 -120 890 -90 890))
(connect D1:4 D6:0
(points 5 272 270 290 270 290 240 520 240 520 270))
(connect D5:1 D7:1
(points 2 390 860 419 860))
(connect D5:2 D7:2
(points 4 390 890 400 890 400 880 419 880))
(connect D5:3 D7:3
(points 4 390 920 400 920 400 900 419 900))
(connect D6:1 D8:0
(points 5 577 280 600 280 600 260 680 260 680 284))
(connect D10:1 D9:1
(points 6 1189 510 1210 510 1210 600 720 600 720 710 736 710))
(connect D4:1 D9:2
(points 2 700 730 736 730))
(connect D7:1 D9:3
(points 6 720 880 740 880 740 800 720 800 720 750 736 750))
(connect D11:1 D10:1
(points 4 1100 520 1110 520 1110 500 1131 500))
(connect D15:0 D10:2
(points 5 550 398 550 420 1120 420 1120 520 1131 520))
(connect D12:1 D11:1
(points 4 775 490 790 490 790 500 799 500))
(connect D12:2 D11:2
(points 2 775 520 799 520))
(connect D12:3 D11:3
(points 4 775 550 790 550 790 540 799 540))
(connect I1:1 D12:1
(points 4 -289 564 42 564 42 490 285 490))
(connect D13:1 D12:2
(points 4 265 530 280 530 280 550 285 550))
(connect D15:1 D13:1
(points 10 600 380 620 380 620 320 480 320 480 420 260 420 260 430 220 430 220
530 235 530))
(connect D1:1 D14:0
(points 5 272 210 300 210 300 300 160 300 160 331))
(connect I1:1 D14:1
(points 6 -289 564 -60 564 -60 430 -70 430 -70 380 -60 380))
(connect D14:1 D15:0
(points 5 379 380 470 380 470 310 550 310 550 344))
(connect D14:1 D15:1
(points 2 379 380 500 380))
(connect D0:1 O1:1
(points 4 424 100 700 100 700 334 358 334))
(connect D9:1 O2:1
(points 2 823 730 358 794)))
(stackingOrder 5 2 7 4 9 0 1 15 14 13 12 11 19 3 6 8 10 16 18 17 20))))
(device 161 CONTEXT
(properties
(name "(4b) Get_All_param")
(trigMode deg)
(nextID 60)
(popupTitleText "UserObject")
(popupMoveable 1))
(interface
(input 1
(name "Chan")
(requires
(datatype Text))
(optional yes))
(output 1
(type data)
(name "Result")
(lock constraints)
(optional yes)))
(deviceList
(device 48 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 First do a catalog of all the traces.  If there are not traces, then stop\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 49 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 We get the number of parameters to read, and loop through them, selecting by trace number\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 51 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Above is the best way to read data.  We query the data, read the header (\"A\"), next is a 1 character text number representing the number of digits in the following number.  We read the following number, which is the number of bytes to transfer.  Then we use binary reads to read the bytes into a 2-D array, representing real and imaginary values\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 52 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 This little trick turns the 2-d array into a 1-D array of complex numbers.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 53 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 And we collect all these arrays of data arrays into a multi-dimension array of parameter data.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 54 COLLECTOR
(properties
(output1D 0))
(interface
(input 1
(name "Data")
(tag "Data"))
(input 2
(type trigger)
(name "XEQ")
(lock name constraints))
(output 1
(name "Array")
(tag "Array"))))
(device 55 FORMULA
(properties
(expr 1 "a[*,0]+j(a[*,1])"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 56 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 6 "WRITE TEXT \"calc\"+chan+\":data:sdata?\" EOL"
"READ TEXT hdr CHAR:1" "READ TEXT digits INT16 MAXFW:1"
"READ TEXT bytes INT32 MAXFW:digits" "READ BINARY sdata REAL32 ARRAY:bytes/8, 2"
"READ BINARY ending BYTE"))
(interface
(input 1
(name "chan")
(requires
(datatype Text))
(optional yes))
(output 1
(name "hdr")
(optional yes))
(output 2
(name "digits")
(optional yes))
(output 3
(name "bytes")
(optional yes))
(output 4
(name "sdata")
(optional yes))
(output 5
(name "ending")
(optional yes)))
(implementation
(iopath "VNA")))
(device 57 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 1 "WRITE TEXT \"calc\"+chan+\":par\"+(par+1)+\":sel;\" EOL"))
(interface
(input 1
(name "par")
(optional yes))
(input 2
(name "chan")
(requires
(datatype Text))
(optional yes)))
(implementation
(iopath "VNA")))
(device 58 FORCOUNT
(properties
(count 4))
(interface
(input 1
(name "Count")
(tag "Count")
(requires
(datatype Int32)
(shape "Scalar"))
(lock constraints)
(optional yes)
(buffer YES))
(output 1
(name "Count")
(lock name constraints))))
(device 59 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 2 "WRITE TEXT \"calc\"+chan+\":par:coun?\" EOL"
"READ TEXT x INT32"))
(interface
(input 1
(name "chan")
(optional yes))
(output 1
(name "x")
(optional yes)))
(implementation
(iopath "VNA")))
(configuration
(connect D6:1 D5:1)
(connect D9:0 D5:2)
(connect D7:4 D6:1)
(connect D8:0 D7:0)
(connect I1:1 D7:1)
(connect D9:1 D8:1)
(connect I1:1 D8:2)
(connect D10:1 D9:1)
(connect I1:1 D10:1)
(connect D5:1 O1:1)))
(contextCarrier
(active detail)
(detail
(extent 1790 1126)
(anchorPt -962 -753)
(configuration
(devCarrierFor 48
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter 490 240))
(devCarrierFor 49
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 116)
(editing enabled))
(pinCenter 950 590))
(devCarrierFor 51
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 414 196)
(editing enabled))
(pinCenter 940 1180))
(devCarrierFor 52
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter 1370 870))
(devCarrierFor 53
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter 1560 1250))
(devCarrierFor 54
(active open)
(icon
(extent 53 25))
(open
(extent 96 54))
(terminals on)
(pinCenter 1360 1130))
(devCarrierFor 55
(active open)
(icon)
(open
(extent 71 50))
(terminals on)
(pinCenter 1280 1000))
(devCarrierFor 56
(active open)
(icon
(extent 80 51)
(iconImage "io.icn"))
(open
(extent 365 137))
(terminals on)
(pinCenter 875 960))
(devCarrierFor 57
(active open)
(icon
(extent 80 51)
(iconImage "io.icn"))
(open
(extent 375 57))
(terminals on)
(pinCenter 835 810))
(devCarrierFor 58
(active open)
(icon
(iconImage "loop.icn"))
(open
(extent 95 31))
(pinCenter 520 790))
(devCarrierFor 59
(active open)
(icon
(extent 80 51)
(iconImage "io.icn"))
(open
(extent 364 126))
(terminals on)
(pinCenter 515 640))
(connect D6:1 D5:1
(points 6 1368 1000 1390 1000 1390 1050 1250 1050 1250 1110 1269 1110))
(connect D9:0 D5:2
(points 7 520 808 520 860 630 860 630 1300 1170 1300 1170 1150 1269 1150))
(connect D7:4 D6:1
(points 4 1110 980 1130 980 1130 1000 1212 1000))
(connect D8:0 D7:0
(points 4 830 841 830 850 880 850 880 871))
(connect I1:1 D7:1
(points 4 962 1315 370 1315 370 960 650 960))
(connect D9:1 D8:1
(points 2 570 790 605 790))
(connect I1:1 D8:2
(points 6 962 1315 370 1315 370 960 580 960 580 830 605 830))
(connect D10:1 D9:1
(points 8 729 640 740 640 740 660 750 660 750 730 450 730 450 790 470 790))
(connect I1:1 D10:1
(points 4 962 1315 250 1315 250 640 290 640))
(connect D5:1 O1:1
(points 4 1450 1130 1470 1130 1470 1315 2751 1315)))
(stackingOrder 0 1 2 4 9 10 8 6 5 3 7))))
(device 162 CONTEXT
(properties
(name "(4b) Get_All_param")
(trigMode deg)
(nextID 60)
(popupTitleText "UserObject")
(popupMoveable 1))
(interface
(input 1
(name "Chan")
(requires
(datatype Text))
(optional yes))
(output 1
(type data)
(name "Result")
(lock constraints)
(optional yes)))
(deviceList
(device 48 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 First do a catalog of all the traces.  If there are not traces, then stop\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 49 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 We get the number of parameters to read, and loop through them, selecting by trace number\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 51 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Above is the best way to read data.  We query the data, read the header (\"A\"), next is a 1 character text number representing the number of digits in the following number.  We read the following number, which is the number of bytes to transfer.  Then we use binary reads to read the bytes into a 2-D array, representing real and imaginary values\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 52 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 This little trick turns the 2-d array into a 1-D array of complex numbers.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 53 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 And we collect all these arrays of data arrays into a multi-dimension array of parameter data.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 54 COLLECTOR
(properties
(output1D 0))
(interface
(input 1
(name "Data")
(tag "Data"))
(input 2
(type trigger)
(name "XEQ")
(lock name constraints))
(output 1
(name "Array")
(tag "Array"))))
(device 55 FORMULA
(properties
(expr 1 "a[*,0]+j(a[*,1])"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 56 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 6 "WRITE TEXT \"calc\"+chan+\":data:sdata?\" EOL"
"READ TEXT hdr CHAR:1" "READ TEXT digits INT16 MAXFW:1"
"READ TEXT bytes INT32 MAXFW:digits" "READ BINARY sdata REAL32 ARRAY:bytes/8, 2"
"READ BINARY ending BYTE"))
(interface
(input 1
(name "chan")
(requires
(datatype Text))
(optional yes))
(output 1
(name "hdr")
(optional yes))
(output 2
(name "digits")
(optional yes))
(output 3
(name "bytes")
(optional yes))
(output 4
(name "sdata")
(optional yes))
(output 5
(name "ending")
(optional yes)))
(implementation
(iopath "VNA")))
(device 57 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 1 "WRITE TEXT \"calc\"+chan+\":par\"+(par+1)+\":sel;\" EOL"))
(interface
(input 1
(name "par")
(optional yes))
(input 2
(name "chan")
(requires
(datatype Text))
(optional yes)))
(implementation
(iopath "VNA")))
(device 58 FORCOUNT
(properties
(count 4))
(interface
(input 1
(name "Count")
(tag "Count")
(requires
(datatype Int32)
(shape "Scalar"))
(lock constraints)
(optional yes)
(buffer YES))
(output 1
(name "Count")
(lock name constraints))))
(device 59 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 2 "WRITE TEXT \"calc\"+chan+\":par:coun?\" EOL"
"READ TEXT x INT32"))
(interface
(input 1
(name "chan")
(optional yes))
(output 1
(name "x")
(optional yes)))
(implementation
(iopath "VNA")))
(configuration
(connect D6:1 D5:1)
(connect D9:0 D5:2)
(connect D7:4 D6:1)
(connect D8:0 D7:0)
(connect I1:1 D7:1)
(connect D9:1 D8:1)
(connect I1:1 D8:2)
(connect D10:1 D9:1)
(connect I1:1 D10:1)
(connect D5:1 O1:1)))
(contextCarrier
(active detail)
(detail
(extent 1790 1126)
(anchorPt -338 -454)
(configuration
(devCarrierFor 48
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter 490 240))
(devCarrierFor 49
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 116)
(editing enabled))
(pinCenter 950 590))
(devCarrierFor 51
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 414 196)
(editing enabled))
(pinCenter 940 1180))
(devCarrierFor 52
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter 1370 870))
(devCarrierFor 53
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter 1560 1250))
(devCarrierFor 54
(active open)
(icon
(extent 53 25))
(open
(extent 96 54))
(terminals on)
(pinCenter 1360 1130))
(devCarrierFor 55
(active open)
(icon)
(open
(extent 71 50))
(terminals on)
(pinCenter 1280 1000))
(devCarrierFor 56
(active open)
(icon
(extent 80 51)
(iconImage "io.icn"))
(open
(extent 365 137))
(terminals on)
(pinCenter 875 960))
(devCarrierFor 57
(active open)
(icon
(extent 80 51)
(iconImage "io.icn"))
(open
(extent 375 57))
(terminals on)
(pinCenter 835 810))
(devCarrierFor 58
(active open)
(icon
(iconImage "loop.icn"))
(open
(extent 95 31))
(pinCenter 520 790))
(devCarrierFor 59
(active open)
(icon
(extent 80 51)
(iconImage "io.icn"))
(open
(extent 364 126))
(terminals on)
(pinCenter 515 640))
(connect D6:1 D5:1
(points 6 1368 1000 1390 1000 1390 1050 1250 1050 1250 1110 1269 1110))
(connect D9:0 D5:2
(points 7 520 808 520 860 630 860 630 1300 1170 1300 1170 1150 1269 1150))
(connect D7:4 D6:1
(points 4 1110 980 1130 980 1130 1000 1212 1000))
(connect D8:0 D7:0
(points 4 830 841 830 850 880 850 880 871))
(connect I1:1 D7:1
(points 4 338 1016 370 1016 370 960 650 960))
(connect D9:1 D8:1
(points 2 570 790 605 790))
(connect I1:1 D8:2
(points 6 338 1016 370 1016 370 960 580 960 580 830 605 830))
(connect D10:1 D9:1
(points 8 729 640 740 640 740 660 750 660 750 730 450 730 450 790 470 790))
(connect I1:1 D10:1
(points 4 338 1016 250 1016 250 640 290 640))
(connect D5:1 O1:1
(points 4 1450 1130 1470 1130 1470 1016 2127 1016)))
(stackingOrder 0 1 2 4 9 10 8 6 5 3 7))))
(device 166 CONTEXT
(properties
(name "(3) ENA_ECAL_and_wait_opc")
(trigMode deg)
(nextID 69)
(popupTitleText "UserObject")
(popupMoveable 1))
(interface
(input 1
(name "Chan")
(optional yes)))
(deviceList
(device 5 EXITCONTEXT)
(device 47 TEXTDISPLAY
(interface
(input 1
(name "Data"))))
(device 41 NEXT)
(device 39 BREAK)
(device 55 IFTHENELSE
(properties
(cases 1 "A==1"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Then")
(lock name constraints))
(output 2
(name "Else")
(lock name constraints))))
(device 53 REPEATUNTILBREAK
(interface
(output 1
(name "Continuous")
(lock name constraints))))
(device 44 CONSTANT
(properties
(name "Poll Time"))
(interface
(output 1
(name "Real")
(lock name constraints)))
(implementation
(value Real
(data  0.06))
(initValue Real
(data  0))))
(device 54 FORMULA
(properties
(name "A/B")
(expr 1 "A/B"))
(interface
(input 1
(name "A")
(optional yes))
(input 2
(name "B")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 38 JUNCTION
(properties
(name "JCT"))
(interface
(input 1
(name "A"))
(input 2
(name "B"))
(output 1
(name "Data"))))
(device 45 MESSAGEBOX
(properties
(autoTimeout 1)
(timeout 3)
(position 201 201)
(message "Waiting for VNA, Press \"Stop\" to Stop")
(symbol Information))
(interface
(output 1
(name "OK")
(lock name constraints))
(output 2
(name "Stop")
(lock name constraints))
(output 3
(name "Timeout")
(lock name constraints)))
(implementation
(customButtons 1)
(displayMode 0)
(buttons "<Custom...>")
(buttonLabel1 "OK")
(buttonLabel2 "Stop")
(buttonLabel3 "")
(bdefault "OK")))
(device 43 CONSTANT
(properties
(name "Total Wait"))
(interface
(output 1
(name "Int32")
(lock name constraints)))
(implementation
(value Int32
(data  3))
(initValue Int32
(data  0))))
(device 37 DELAY
(properties
(delay 0.06))
(interface
(input 1
(name "Delay")
(tag "Delay")
(requires
(datatype Real64)
(shape "Scalar"))
(lock constraints)
(optional yes)
(buffer YES))
(output 1
(name "Done"))))
(device 36 FORCOUNT
(properties
(count 50))
(interface
(input 1
(name "Count")
(tag "Count")
(requires
(datatype Int32)
(shape "Scalar"))
(lock constraints)
(optional yes)
(buffer YES))
(output 1
(name "Count")
(lock name constraints))))
(device 35 BREAK)
(device 34 IFTHENELSE
(properties
(cases 1 "A==1"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Then")
(lock name constraints))
(output 2
(name "Else")
(lock name constraints))))
(device 46 FORMULA
(properties
(name "bit(x,n)")
(expr 1 "bit(x, 5)"))
(interface
(input 1
(name "x")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 56 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 This takes one sweep.  VNA sweep times can range from a few milliseconds to tens of seconds.  To avoid a Direct I/O time-out, we will use polling of the status byte to see when the sweep is finished.  After a time specified in the \"Total Wait\" box, a message pops up to say we\'re waiting.  It will disappear by itself, or you can OK it.  If you hit cancel, the program will terminate (without creating an I/O timeout error.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 49 SCROLLINGTEXTDISPLAY
(properties
(logSize 256))
(interface
(input 1
(name "Data"))))
(device 52 SERIALPOLL
(properties
(name "Spoll: VNA ( @ 916)")
(iopath "VNA")
(busType 1)
(event spoll)
(sense nowait)
(mask 0x20))
(interface
(output 1
(name "status")
(lock name constraints)))
(implementation))
(device 58 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 For each loop, we use the \"For Count\" to poll the status byte. After the total wait time, we pop the message block to give a choice of stopping\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 59 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 We divide the total wait time by the polling time, to get the number of polls that we should make.  We don\'t poll really fast because each time the ENA response to the poll, it slows it down a little bit\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 62 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Here we clear the status byte, then enable the status register to receive the OPC (operation complete).  We take an ECal sweep (Set the trigger source to bus, and turn continuous sweep on, then initiate ECal).  Then send the OPC command and start waiting.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 63 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 This IF/Then tests for the OPC bit on the status byte.  IF it returns true, we can break out and exit.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 64 NOTE
(properties
(name "Whodunit")
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Joel Dunsmore  \\par\r\nand Dara Sariaslani\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 66 EXITPROCESS
(properties
(code 0)))
(device 67 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 3 "WRITE TEXT \"*cls;*ese 1\" EOL"
"WRITE TEXT \"trig:sour bus\" EOL" "WRITE TEXT \"init\"+chan+\":cont on\" EOL"))
(interface
(input 1
(name "chan")
(optional yes)))
(implementation
(iopath "VNA")))
(device 68 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 2 "WRITE TEXT \"sens\"+chan+\":corr:coll:ecal:solt2 1,2\" EOL"
"WRITE TEXT \"*opc\" EOL"))
(interface
(input 1
(name "chan")
(optional yes)))
(implementation
(iopath "VNA")))
(configuration
(connect D5:0 D0:0)
(connect D12:1 D1:1)
(connect D8:1 D2:0)
(connect D4:1 D3:0)
(connect D12:0 D4:0)
(connect D15:1 D4:1)
(connect D26:0 D5:0)
(connect D10:1 D7:1)
(connect D6:1 D7:2)
(connect D9:1 D8:1)
(connect D9:3 D8:2)
(connect D4:2 D9:0)
(connect D12:1 D11:0)
(connect D6:1 D11:1)
(connect D5:1 D12:0)
(connect D7:1 D12:1)
(connect D14:1 D13:0)
(connect D15:1 D14:1)
(connect D17:0 D15:0)
(connect D18:1 D15:1)
(connect D18:1 D17:1)
(connect D11:1 D18:0)
(connect D9:2 D24:0)
(connect I1:1 D25:1)
(connect D25:0 D26:0)
(connect I1:1 D26:1)))
(contextCarrier
(active detail)
(detail
(extent 669 741)
(anchorPt 87 544)
(configuration
(devCarrierFor 5
(active icon)
(icon
(extent 105 16))
(open)
(terminals on)
(pinCenter 270 950))
(devCarrierFor 47
(active open)
(icon
(extent 85 15))
(open
(extent 131 28))
(pinCenter 440 370))
(devCarrierFor 41
(active icon)
(icon
(extent 31 16))
(open)
(terminals on)
(pinCenter 550 780))
(devCarrierFor 39
(active icon)
(icon
(extent 41 16))
(open)
(terminals on)
(pinCenter 410 600))
(devCarrierFor 55
(active icon)
(icon
(extent 82 25))
(open
(extent 65 53))
(terminals on)
(pinCenter 280 560))
(devCarrierFor 53
(active icon)
(icon
(extent 74 52)
(iconImage "loop.icn"))
(open)
(terminals on)
(pinCenter 260 280))
(devCarrierFor 44
(active open)
(icon
(extent 63 0))
(open
(extent 99 30)
(showFormat real))
(pinCenter 50 500))
(devCarrierFor 54
(active icon)
(icon
(extent 24 25))
(open
(extent 72 50))
(terminals on)
(pinCenter 160 450))
(devCarrierFor 38
(active icon)
(icon
(extent 29 25))
(open)
(terminals on)
(pinCenter 490 780))
(devCarrierFor 45
(active icon)
(icon
(extent 92 34))
(open
(extent 236 129))
(terminals on)
(pinCenter 290 780))
(devCarrierFor 43
(active open)
(icon
(extent 70 0))
(open
(extent 106 30)
(showFormat int))
(pinCenter 50 430))
(devCarrierFor 37
(active open)
(icon)
(open
(extent 76 32))
(pinCenter 420 450))
(devCarrierFor 36
(active open)
(icon
(iconImage "loop.icn"))
(open
(extent 106 32))
(pinCenter 280 450))
(devCarrierFor 35
(active icon)
(icon
(extent 41 16))
(open)
(terminals on)
(pinCenter 1190 540))
(devCarrierFor 34
(active open)
(icon)
(open
(extent 61 53))
(terminals on)
(pinCenter 1165 480))
(devCarrierFor 46
(active open)
(icon
(extent 47 0))
(open
(extent 81 50))
(terminals on)
(pinCenter 980 480))
(devCarrierFor 56
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 714 196)
(editing enabled))
(pinCenter 400 -110))
(devCarrierFor 49
(active open)
(icon
(extent 156 16))
(open
(extent 192 172)
(formatter
(realFormat standard)
(realSigDigits 8)
(realRadixSpec 4)
(integerBase binary)))
(pinCenter 1070 950))
(devCarrierFor 52
(active open)
(icon
(extent 117 52)
(iconImage "io.icn"))
(open
(extent 235 106))
(terminals on)
(pinCenter 660 900))
(devCarrierFor 58
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter -30 310))
(devCarrierFor 59
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 126)
(editing enabled))
(pinCenter -230 490))
(devCarrierFor 62
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 384 156)
(editing enabled))
(pinCenter 690 100))
(devCarrierFor 63
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter -10 640))
(devCarrierFor 64
(active icon)
(icon
(extent 68 51)
(iconImage "notepad.icn"))
(open
(extent 184 106)
(editing enabled))
(pinCenter 510 -300))
(devCarrierFor 66
(active open)
(icon
(iconImage "stop.icn"))
(open
(extent 65 31))
(pinCenter 410 850))
(devCarrierFor 67
(active open)
(icon
(extent 80 52)
(iconImage "io.icn"))
(open
(extent 345 87))
(terminals on)
(pinCenter 275 60))
(devCarrierFor 68
(active open)
(icon
(extent 80 52)
(iconImage "io.icn"))
(open
(extent 324 66))
(terminals on)
(pinCenter 265 170))
(connect D5:0 D0:0
(points 10 260 308 260 330 200 330 200 500 210 500 210 570 220 570 220 820 270
820 270 939))
(connect D12:1 D1:1
(points 8 335 450 350 450 350 440 360 440 360 390 350 390 350 370 372 370))
(connect D8:1 D2:0
(points 5 507 780 520 780 520 750 550 750 550 769))
(connect D4:1 D3:0
(points 3 323 550 410 550 410 589))
(connect D12:0 D4:0
(points 2 280 468 280 545))
(connect D15:1 D4:1
(points 6 1073 480 1080 480 1080 530 220 530 220 560 236 560))
(connect D26:0 D5:0
(points 2 260 205 260 251))
(connect D10:1 D7:1
(points 4 105 430 130 430 130 440 145 440))
(connect D6:1 D7:2
(points 6 102 500 120 500 120 490 130 490 130 460 145 460))
(connect D9:1 D8:1
(points 2 338 770 473 770))
(connect D9:3 D8:2
(points 2 338 790 473 790))
(connect D4:2 D9:0
(points 5 323 570 340 570 340 600 290 600 290 760))
(connect D12:1 D11:0
(points 7 335 450 350 450 350 440 360 440 360 390 420 390 420 413))
(connect D6:1 D11:1
(points 6 102 500 120 500 120 490 360 490 360 450 379 450))
(connect D5:1 D12:0
(points 5 299 280 320 280 320 330 280 330 280 413))
(connect D7:1 D12:1
(points 2 174 450 224 450))
(connect D14:1 D13:0
(points 5 1238 470 1260 470 1260 520 1190 520 1190 529))
(connect D15:1 D14:1
(points 2 1073 480 1102 480))
(connect D17:0 D15:0
(points 8 1070 1038 1070 1060 1190 1060 1190 580 1090 580 1090 410 990 410 990
434))
(connect D18:1 D15:1
(points 4 830 900 860 900 860 480 907 480))
(connect D18:1 D17:1
(points 4 830 900 850 900 850 950 971 950))
(connect D11:1 D18:0
(points 5 460 450 520 450 520 540 670 540 670 826))
(connect D9:2 D24:0
(points 3 338 780 410 780 410 814))
(connect I1:1 D25:1
(points 4 -87 -174 -460 -174 -460 60 60 60))
(connect D25:0 D26:0
(points 2 270 106 260 116))
(connect I1:1 D26:1
(points 4 -87 -174 -151 -174 -151 170 60 170)))
(stackingOrder 13 12 11 10 6 16 17 1 20 7 5 3 8 2 22 0 24 19 25 26 21 18 15 14 4
9 23))))
(device 167 CONTEXT
(properties
(name "(3) ENA_sing_and_wait_opc")
(trigMode deg)
(nextID 69)
(popupTitleText "UserObject")
(popupMoveable 1))
(interface
(input 1
(name "Chan")
(optional yes)))
(deviceList
(device 5 EXITCONTEXT)
(device 50 SCROLLINGTEXTDISPLAY
(properties
(logSize 256))
(interface
(input 1
(name "Data"))))
(device 48 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 2 "WRITE TEXT \"*stb?\" EOL" "READ TEXT x BYTE"))
(interface
(output 1
(name "x")
(optional yes)))
(implementation
(iopath "VNA")))
(device 47 TEXTDISPLAY
(interface
(input 1
(name "Data"))))
(device 41 NEXT)
(device 39 BREAK)
(device 55 IFTHENELSE
(properties
(cases 1 "A==1"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Then")
(lock name constraints))
(output 2
(name "Else")
(lock name constraints))))
(device 53 REPEATUNTILBREAK
(interface
(output 1
(name "Continuous")
(lock name constraints))))
(device 44 CONSTANT
(properties
(name "Poll Time"))
(interface
(output 1
(name "Real")
(lock name constraints)))
(implementation
(value Real
(data  0.06))
(initValue Real
(data  0))))
(device 54 FORMULA
(properties
(name "A/B")
(expr 1 "A/B"))
(interface
(input 1
(name "A")
(optional yes))
(input 2
(name "B")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 38 JUNCTION
(properties
(name "JCT"))
(interface
(input 1
(name "A"))
(input 2
(name "B"))
(output 1
(name "Data"))))
(device 45 MESSAGEBOX
(properties
(autoTimeout 1)
(timeout 3)
(position 201 201)
(message "Waiting for VNA, Press \"Stop\" to Stop")
(symbol Information))
(interface
(output 1
(name "OK")
(lock name constraints))
(output 2
(name "Stop")
(lock name constraints))
(output 3
(name "Timeout")
(lock name constraints)))
(implementation
(customButtons 1)
(displayMode 0)
(buttons "<Custom...>")
(buttonLabel1 "OK")
(buttonLabel2 "Stop")
(buttonLabel3 "")
(bdefault "OK")))
(device 43 CONSTANT
(properties
(name "Total Wait"))
(interface
(output 1
(name "Int32")
(lock name constraints)))
(implementation
(value Int32
(data  3))
(initValue Int32
(data  0))))
(device 37 DELAY
(properties
(delay 0.06))
(interface
(input 1
(name "Delay")
(tag "Delay")
(requires
(datatype Real64)
(shape "Scalar"))
(lock constraints)
(optional yes)
(buffer YES))
(output 1
(name "Done"))))
(device 36 FORCOUNT
(properties
(count 50))
(interface
(input 1
(name "Count")
(tag "Count")
(requires
(datatype Int32)
(shape "Scalar"))
(lock constraints)
(optional yes)
(buffer YES))
(output 1
(name "Count")
(lock name constraints))))
(device 35 BREAK)
(device 34 IFTHENELSE
(properties
(cases 1 "A==1"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Then")
(lock name constraints))
(output 2
(name "Else")
(lock name constraints))))
(device 46 FORMULA
(properties
(name "bit(x,n)")
(expr 1 "bit(x, 5)"))
(interface
(input 1
(name "x")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 56 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 This takes one sweep.  VNA sweep times can range from a few milliseconds to tens of seconds.  To avoid a Direct I/O time-out, we will use polling of the status byte to see when the sweep is finished.  After a time specified in the \"Total Wait\" box, a message pops up to say we\'re waiting.  It will disappear by itself, or you can OK it.  If you hit cancel, the program will terminate (without creating an I/O timeout error.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 49 SCROLLINGTEXTDISPLAY
(properties
(logSize 256))
(interface
(input 1
(name "Data"))))
(device 52 SERIALPOLL
(properties
(name "Spoll: VNA ( @ 916)")
(iopath "VNA")
(busType 1)
(event spoll)
(sense nowait)
(mask 0x20))
(interface
(output 1
(name "status")
(lock name constraints)))
(implementation))
(device 58 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 For each loop, we use the \"For Count\" to poll the status byte. After the total wait time, we pop the message block to give a choice of stopping\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 59 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 We divide the total wait time by the polling time, to get the number of polls that we should make.  We don\'t poll really fast because each time the PNA response to the poll, it slows it down a little bit\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 60 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 You can read the status byte directly, which we do here.  Then we look for the bit corresponding to the OPC finished.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 61 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Or you can Spoll the status byte, but Spoll on the PNA doesn\'t work using \"SCPI-over-LAN\" in firmware versions earlier than 5.0, so we just show it for reference.  Note: it works fine using a GP-IB card or USB-to-GPIB adapter.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 62 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Here we clear the status byte, then enable the status register to receive the OPC (operation complete).  We take a single sweep (Set the trigger source to bus, and turn continuous sweep on, then send a bus trigger).  Then send the OPC command and start waiting.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 63 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 This IF/Then tests for the OPC bit on the status byte.  IF it returns true, we can break out and exit.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 64 NOTE
(properties
(name "Whodunit")
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Joel Dunsmore  \\par\r\nand Dara Sariaslani\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 66 EXITPROCESS
(properties
(code 0)))
(device 67 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 3 "WRITE TEXT \"*cls;*ese 1\" EOL"
"WRITE TEXT \"trig:sour bus\" EOL" "WRITE TEXT \"init\"+chan+\":cont on\" EOL"))
(interface
(input 1
(name "chan")
(optional yes)))
(implementation
(iopath "VNA")))
(device 68 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 2 "WRITE TEXT \"trig:sing\" EOL" "WRITE TEXT \"*opc\" EOL"))
(implementation
(iopath "VNA")))
(configuration
(connect D7:0 D0:0)
(connect D2:1 D1:1)
(connect D13:1 D2:0)
(connect D14:1 D3:1)
(connect D10:1 D4:0)
(connect D6:1 D5:0)
(connect D14:0 D6:0)
(connect D17:1 D6:1)
(connect D30:0 D7:0)
(connect D12:1 D9:1)
(connect D8:1 D9:2)
(connect D11:1 D10:1)
(connect D11:3 D10:2)
(connect D6:2 D11:0)
(connect D14:1 D13:0)
(connect D8:1 D13:1)
(connect D7:1 D14:0)
(connect D9:1 D14:1)
(connect D16:1 D15:0)
(connect D17:1 D16:1)
(connect D19:0 D17:0)
(connect D2:1 D17:1)
(connect D1:0 D19:0)
(connect D20:1 D19:1)
(connect D13:1 D20:0)
(connect D11:2 D28:0)
(connect I1:1 D29:1)
(connect D29:0 D30:0)))
(contextCarrier
(active detail)
(detail
(extent 350 300)
(anchorPt -19 240)
(configuration
(devCarrierFor 5
(active icon)
(icon
(extent 105 16))
(open)
(terminals on)
(pinCenter 270 950))
(devCarrierFor 50
(active open)
(icon
(extent 156 16))
(open
(extent 192 172)
(formatter
(realFormat standard)
(realSigDigits 8)
(realRadixSpec 4)
(integerBase binary)))
(pinCenter 1070 710))
(devCarrierFor 48
(active open)
(icon
(extent 80 0)
(iconImage "io.icn"))
(open
(extent 229 74))
(terminals on)
(pinCenter 690 480))
(devCarrierFor 47
(active open)
(icon
(extent 85 15))
(open
(extent 131 28))
(pinCenter 440 370))
(devCarrierFor 41
(active icon)
(icon
(extent 31 16))
(open)
(terminals on)
(pinCenter 550 780))
(devCarrierFor 39
(active icon)
(icon
(extent 41 16))
(open)
(terminals on)
(pinCenter 410 600))
(devCarrierFor 55
(active icon)
(icon
(extent 82 25))
(open
(extent 65 53))
(terminals on)
(pinCenter 280 560))
(devCarrierFor 53
(active icon)
(icon
(extent 74 52)
(iconImage "loop.icn"))
(open)
(terminals on)
(pinCenter 260 280))
(devCarrierFor 44
(active open)
(icon
(extent 63 0))
(open
(extent 99 30)
(showFormat real))
(pinCenter 50 500))
(devCarrierFor 54
(active icon)
(icon
(extent 24 25))
(open
(extent 72 50))
(terminals on)
(pinCenter 160 450))
(devCarrierFor 38
(active icon)
(icon
(extent 29 25))
(open)
(terminals on)
(pinCenter 490 780))
(devCarrierFor 45
(active icon)
(icon
(extent 92 34))
(open
(extent 236 129))
(terminals on)
(pinCenter 290 780))
(devCarrierFor 43
(active open)
(icon
(extent 70 0))
(open
(extent 106 30)
(showFormat int))
(pinCenter 50 430))
(devCarrierFor 37
(active open)
(icon)
(open
(extent 76 32))
(pinCenter 420 450))
(devCarrierFor 36
(active open)
(icon
(iconImage "loop.icn"))
(open
(extent 106 32))
(pinCenter 280 450))
(devCarrierFor 35
(active icon)
(icon
(extent 41 16))
(open)
(terminals on)
(pinCenter 1190 540))
(devCarrierFor 34
(active open)
(icon)
(open
(extent 61 53))
(terminals on)
(pinCenter 1165 480))
(devCarrierFor 46
(active open)
(icon
(extent 47 0))
(open
(extent 81 50))
(terminals on)
(pinCenter 980 480))
(devCarrierFor 56
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 714 196)
(editing enabled))
(pinCenter 400 -110))
(devCarrierFor 49
(active open)
(icon
(extent 156 16))
(open
(extent 192 172)
(formatter
(realFormat standard)
(realSigDigits 8)
(realRadixSpec 4)
(integerBase binary)))
(pinCenter 1070 950))
(devCarrierFor 52
(active open)
(icon
(extent 117 52)
(iconImage "io.icn"))
(open
(extent 235 106))
(terminals on)
(pinCenter 660 900))
(devCarrierFor 58
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter -30 310))
(devCarrierFor 59
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 126)
(editing enabled))
(pinCenter -230 490))
(devCarrierFor 60
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter 740 330))
(devCarrierFor 61
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 424 136)
(editing enabled))
(pinCenter 720 1060))
(devCarrierFor 62
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 384 156)
(editing enabled))
(pinCenter 710 120))
(devCarrierFor 63
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter -10 640))
(devCarrierFor 64
(active icon)
(icon
(extent 68 51)
(iconImage "notepad.icn"))
(open
(extent 224 76)
(editing enabled))
(pinCenter 410 -310))
(devCarrierFor 66
(active open)
(icon
(iconImage "stop.icn"))
(open
(extent 65 31))
(pinCenter 410 850))
(devCarrierFor 67
(active open)
(icon
(extent 80 52)
(iconImage "io.icn"))
(open
(extent 345 87))
(terminals on)
(pinCenter 275 60))
(devCarrierFor 68
(active open)
(icon
(extent 80 52)
(iconImage "io.icn"))
(open
(extent 324 66))
(terminals on)
(pinCenter 260 170))
(connect D7:0 D0:0
(points 10 260 308 260 330 200 330 200 500 210 500 210 570 220 570 220 820 270
820 270 939))
(connect D2:1 D1:1
(points 6 837 480 860 480 860 550 840 550 840 710 971 710))
(connect D13:1 D2:0
(points 5 460 450 520 450 520 400 690 400 690 422))
(connect D14:1 D3:1
(points 8 335 450 350 450 350 440 360 440 360 390 350 390 350 370 372 370))
(connect D10:1 D4:0
(points 5 507 780 520 780 520 750 550 750 550 769))
(connect D6:1 D5:0
(points 5 323 550 350 550 350 570 410 570 410 589))
(connect D14:0 D6:0
(points 2 280 468 280 545))
(connect D17:1 D6:1
(points 8 1073 480 1060 480 1060 560 380 560 380 530 220 530 220 560 236 560))
(connect D30:0 D7:0
(points 2 260 205 260 251))
(connect D12:1 D9:1
(points 4 105 430 130 430 130 440 145 440))
(connect D8:1 D9:2
(points 6 102 500 120 500 120 490 130 490 130 460 145 460))
(connect D11:1 D10:1
(points 2 338 770 473 770))
(connect D11:3 D10:2
(points 2 338 790 473 790))
(connect D6:2 D11:0
(points 5 323 570 340 570 340 600 290 600 290 760))
(connect D14:1 D13:0
(points 7 335 450 350 450 350 440 360 440 360 390 420 390 420 413))
(connect D8:1 D13:1
(points 6 102 500 120 500 120 490 360 490 360 450 379 450))
(connect D7:1 D14:0
(points 5 299 280 320 280 320 330 280 330 280 413))
(connect D9:1 D14:1
(points 2 174 450 224 450))
(connect D16:1 D15:0
(points 5 1238 470 1260 470 1260 520 1190 520 1190 529))
(connect D17:1 D16:1
(points 2 1073 480 1102 480))
(connect D19:0 D17:0
(points 8 1070 1038 1070 1060 1190 1060 1190 580 1090 580 1090 410 990 410 990
434))
(connect D2:1 D17:1
(points 2 837 480 907 480))
(connect D1:0 D19:0
(points 2 1070 798 1070 843))
(connect D20:1 D19:1
(points 4 830 900 850 900 850 950 971 950))
(connect D13:1 D20:0
(points 5 460 450 520 450 520 540 670 540 670 826))
(connect D11:2 D28:0
(points 3 338 780 410 780 410 814))
(connect I1:1 D29:1
(points 4 19 -91 -460 -91 -460 60 60 60))
(connect D29:0 D30:0
(points 2 270 106 260 116)))
(stackingOrder 16 15 14 13 12 8 17 1 18 19 2 20 3 22 9 7 23 25 6 5 10 4 26 0 24
28 11 30 21 29 27))))
(device 168 CONTEXT
(properties
(name "(3) ENA_sing_and_wait_opc")
(trigMode deg)
(nextID 69)
(popupTitleText "UserObject")
(popupMoveable 1))
(interface
(input 1
(name "Chan")
(optional yes)))
(deviceList
(device 5 EXITCONTEXT)
(device 50 SCROLLINGTEXTDISPLAY
(properties
(logSize 256))
(interface
(input 1
(name "Data"))))
(device 48 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 2 "WRITE TEXT \"*stb?\" EOL" "READ TEXT x BYTE"))
(interface
(output 1
(name "x")
(optional yes)))
(implementation
(iopath "VNA")))
(device 47 TEXTDISPLAY
(interface
(input 1
(name "Data"))))
(device 41 NEXT)
(device 39 BREAK)
(device 55 IFTHENELSE
(properties
(cases 1 "A==1"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Then")
(lock name constraints))
(output 2
(name "Else")
(lock name constraints))))
(device 53 REPEATUNTILBREAK
(interface
(output 1
(name "Continuous")
(lock name constraints))))
(device 44 CONSTANT
(properties
(name "Poll Time"))
(interface
(output 1
(name "Real")
(lock name constraints)))
(implementation
(value Real
(data  0.06))
(initValue Real
(data  0))))
(device 54 FORMULA
(properties
(name "A/B")
(expr 1 "A/B"))
(interface
(input 1
(name "A")
(optional yes))
(input 2
(name "B")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 38 JUNCTION
(properties
(name "JCT"))
(interface
(input 1
(name "A"))
(input 2
(name "B"))
(output 1
(name "Data"))))
(device 45 MESSAGEBOX
(properties
(autoTimeout 1)
(timeout 3)
(position 201 201)
(message "Waiting for VNA, Press \"Stop\" to Stop")
(symbol Information))
(interface
(output 1
(name "OK")
(lock name constraints))
(output 2
(name "Stop")
(lock name constraints))
(output 3
(name "Timeout")
(lock name constraints)))
(implementation
(customButtons 1)
(displayMode 0)
(buttons "<Custom...>")
(buttonLabel1 "OK")
(buttonLabel2 "Stop")
(buttonLabel3 "")
(bdefault "OK")))
(device 43 CONSTANT
(properties
(name "Total Wait"))
(interface
(output 1
(name "Int32")
(lock name constraints)))
(implementation
(value Int32
(data  3))
(initValue Int32
(data  0))))
(device 37 DELAY
(properties
(delay 0.06))
(interface
(input 1
(name "Delay")
(tag "Delay")
(requires
(datatype Real64)
(shape "Scalar"))
(lock constraints)
(optional yes)
(buffer YES))
(output 1
(name "Done"))))
(device 36 FORCOUNT
(properties
(count 50))
(interface
(input 1
(name "Count")
(tag "Count")
(requires
(datatype Int32)
(shape "Scalar"))
(lock constraints)
(optional yes)
(buffer YES))
(output 1
(name "Count")
(lock name constraints))))
(device 35 BREAK)
(device 34 IFTHENELSE
(properties
(cases 1 "A==1"))
(interface
(input 1
(name "A")
(optional yes))
(output 1
(name "Then")
(lock name constraints))
(output 2
(name "Else")
(lock name constraints))))
(device 46 FORMULA
(properties
(name "bit(x,n)")
(expr 1 "bit(x, 5)"))
(interface
(input 1
(name "x")
(optional yes))
(output 1
(name "Result")
(tag "Result")
(lock name constraints)
(optional yes))))
(device 56 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 This takes one sweep.  VNA sweep times can range from a few milliseconds to tens of seconds.  To avoid a Direct I/O time-out, we will use polling of the status byte to see when the sweep is finished.  After a time specified in the \"Total Wait\" box, a message pops up to say we\'re waiting.  It will disappear by itself, or you can OK it.  If you hit cancel, the program will terminate (without creating an I/O timeout error.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 49 SCROLLINGTEXTDISPLAY
(properties
(logSize 256))
(interface
(input 1
(name "Data"))))
(device 52 SERIALPOLL
(properties
(name "Spoll: VNA ( @ 916)")
(iopath "VNA")
(busType 1)
(event spoll)
(sense nowait)
(mask 0x20))
(interface
(output 1
(name "status")
(lock name constraints)))
(implementation))
(device 58 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 For each loop, we use the \"For Count\" to poll the status byte. After the total wait time, we pop the message block to give a choice of stopping\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 59 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 We divide the total wait time by the polling time, to get the number of polls that we should make.  We don\'t poll really fast because each time the PNA response to the poll, it slows it down a little bit\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 60 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 You can read the status byte directly, which we do here.  Then we look for the bit corresponding to the OPC finished.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 61 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Or you can Spoll the status byte, but Spoll on the PNA doesn\'t work using \"SCPI-over-LAN\" in firmware versions earlier than 5.0, so we just show it for reference.  Note: it works fine using a GP-IB card or USB-to-GPIB adapter.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 62 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Here we clear the status byte, then enable the status register to receive the OPC (operation complete).  We take a single sweep (Set the trigger source to bus, and turn continuous sweep on, then send a bus trigger).  Then send the OPC command and start waiting.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 63 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 This IF/Then tests for the OPC bit on the status byte.  IF it returns true, we can break out and exit.\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 64 NOTE
(properties
(name "Whodunit")
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}{\\f1\\froman\\fprq2\\fcharset0 Times New Roman;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Joel Dunsmore  \\par\r\nand Dara Sariaslani\\b\\f1\\fs28\\par\r\n}\r\n"
)))
(device 66 EXITPROCESS
(properties
(code 0)))
(device 67 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 3 "WRITE TEXT \"*cls;*ese 1\" EOL"
"WRITE TEXT \"trig:sour bus\" EOL" "WRITE TEXT \"init\"+chan+\":cont on\" EOL"))
(interface
(input 1
(name "chan")
(optional yes)))
(implementation
(iopath "VNA")))
(device 68 IODEVICE
(properties
(name "VNA ( @ 916)")
(transactions 2 "WRITE TEXT \"trig:sing\" EOL" "WRITE TEXT \"*opc\" EOL"))
(implementation
(iopath "VNA")))
(configuration
(connect D7:0 D0:0)
(connect D2:1 D1:1)
(connect D13:1 D2:0)
(connect D14:1 D3:1)
(connect D10:1 D4:0)
(connect D6:1 D5:0)
(connect D14:0 D6:0)
(connect D17:1 D6:1)
(connect D30:0 D7:0)
(connect D12:1 D9:1)
(connect D8:1 D9:2)
(connect D11:1 D10:1)
(connect D11:3 D10:2)
(connect D6:2 D11:0)
(connect D14:1 D13:0)
(connect D8:1 D13:1)
(connect D7:1 D14:0)
(connect D9:1 D14:1)
(connect D16:1 D15:0)
(connect D17:1 D16:1)
(connect D19:0 D17:0)
(connect D2:1 D17:1)
(connect D1:0 D19:0)
(connect D20:1 D19:1)
(connect D13:1 D20:0)
(connect D11:2 D28:0)
(connect I1:1 D29:1)
(connect D29:0 D30:0)))
(contextCarrier
(active detail)
(detail
(extent 350 300)
(anchorPt 8 283)
(configuration
(devCarrierFor 5
(active icon)
(icon
(extent 105 16))
(open)
(terminals on)
(pinCenter 270 950))
(devCarrierFor 50
(active open)
(icon
(extent 156 16))
(open
(extent 192 172)
(formatter
(realFormat standard)
(realSigDigits 8)
(realRadixSpec 4)
(integerBase binary)))
(pinCenter 1070 710))
(devCarrierFor 48
(active open)
(icon
(extent 80 0)
(iconImage "io.icn"))
(open
(extent 229 74))
(terminals on)
(pinCenter 690 480))
(devCarrierFor 47
(active open)
(icon
(extent 85 15))
(open
(extent 131 28))
(pinCenter 440 370))
(devCarrierFor 41
(active icon)
(icon
(extent 31 16))
(open)
(terminals on)
(pinCenter 550 780))
(devCarrierFor 39
(active icon)
(icon
(extent 41 16))
(open)
(terminals on)
(pinCenter 410 600))
(devCarrierFor 55
(active icon)
(icon
(extent 82 25))
(open
(extent 65 53))
(terminals on)
(pinCenter 280 560))
(devCarrierFor 53
(active icon)
(icon
(extent 74 52)
(iconImage "loop.icn"))
(open)
(terminals on)
(pinCenter 260 280))
(devCarrierFor 44
(active open)
(icon
(extent 63 0))
(open
(extent 99 30)
(showFormat real))
(pinCenter 50 500))
(devCarrierFor 54
(active icon)
(icon
(extent 24 25))
(open
(extent 72 50))
(terminals on)
(pinCenter 160 450))
(devCarrierFor 38
(active icon)
(icon
(extent 29 25))
(open)
(terminals on)
(pinCenter 490 780))
(devCarrierFor 45
(active icon)
(icon
(extent 92 34))
(open
(extent 236 129))
(terminals on)
(pinCenter 290 780))
(devCarrierFor 43
(active open)
(icon
(extent 70 0))
(open
(extent 106 30)
(showFormat int))
(pinCenter 50 430))
(devCarrierFor 37
(active open)
(icon)
(open
(extent 76 32))
(pinCenter 420 450))
(devCarrierFor 36
(active open)
(icon
(iconImage "loop.icn"))
(open
(extent 106 32))
(pinCenter 280 450))
(devCarrierFor 35
(active icon)
(icon
(extent 41 16))
(open)
(terminals on)
(pinCenter 1190 540))
(devCarrierFor 34
(active open)
(icon)
(open
(extent 61 53))
(terminals on)
(pinCenter 1165 480))
(devCarrierFor 46
(active open)
(icon
(extent 47 0))
(open
(extent 81 50))
(terminals on)
(pinCenter 980 480))
(devCarrierFor 56
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 714 196)
(editing enabled))
(pinCenter 400 -110))
(devCarrierFor 49
(active open)
(icon
(extent 156 16))
(open
(extent 192 172)
(formatter
(realFormat standard)
(realSigDigits 8)
(realRadixSpec 4)
(integerBase binary)))
(pinCenter 1070 950))
(devCarrierFor 52
(active open)
(icon
(extent 117 52)
(iconImage "io.icn"))
(open
(extent 180 106))
(terminals on)
(pinCenter 630 900))
(devCarrierFor 58
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter -30 310))
(devCarrierFor 59
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 126)
(editing enabled))
(pinCenter -230 490))
(devCarrierFor 60
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter 740 330))
(devCarrierFor 61
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 424 136)
(editing enabled))
(pinCenter 720 1060))
(devCarrierFor 62
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 384 156)
(editing enabled))
(pinCenter 710 120))
(devCarrierFor 63
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 404 86)
(editing enabled))
(pinCenter -10 640))
(devCarrierFor 64
(active icon)
(icon
(extent 68 51)
(iconImage "notepad.icn"))
(open
(extent 224 96)
(editing enabled))
(pinCenter 390 -340))
(devCarrierFor 66
(active open)
(icon
(iconImage "stop.icn"))
(open
(extent 65 31))
(pinCenter 410 850))
(devCarrierFor 67
(active open)
(icon
(extent 80 52)
(iconImage "io.icn"))
(open
(extent 345 87))
(terminals on)
(pinCenter 275 60))
(devCarrierFor 68
(active open)
(icon
(extent 80 52)
(iconImage "io.icn"))
(open
(extent 324 66))
(terminals on)
(pinCenter 260 170))
(connect D7:0 D0:0
(points 10 260 308 260 330 200 330 200 500 210 500 210 570 220 570 220 820 270
820 270 939))
(connect D2:1 D1:1
(points 6 837 480 860 480 860 550 840 550 840 710 971 710))
(connect D13:1 D2:0
(points 5 460 450 520 450 520 400 690 400 690 422))
(connect D14:1 D3:1
(points 8 335 450 350 450 350 440 360 440 360 390 350 390 350 370 372 370))
(connect D10:1 D4:0
(points 5 507 780 520 780 520 750 550 750 550 769))
(connect D6:1 D5:0
(points 5 323 550 350 550 350 570 410 570 410 589))
(connect D14:0 D6:0
(points 2 280 468 280 545))
(connect D17:1 D6:1
(points 8 1073 480 1060 480 1060 560 380 560 380 530 220 530 220 560 236 560))
(connect D30:0 D7:0
(points 2 260 205 260 251))
(connect D12:1 D9:1
(points 4 105 430 130 430 130 440 145 440))
(connect D8:1 D9:2
(points 6 102 500 120 500 120 490 130 490 130 460 145 460))
(connect D11:1 D10:1
(points 2 338 770 473 770))
(connect D11:3 D10:2
(points 2 338 790 473 790))
(connect D6:2 D11:0
(points 5 323 570 340 570 340 600 290 600 290 760))
(connect D14:1 D13:0
(points 7 335 450 350 450 350 440 360 440 360 390 420 390 420 413))
(connect D8:1 D13:1
(points 6 102 500 120 500 120 490 360 490 360 450 379 450))
(connect D7:1 D14:0
(points 5 299 280 320 280 320 330 280 330 280 413))
(connect D9:1 D14:1
(points 2 174 450 224 450))
(connect D16:1 D15:0
(points 5 1238 470 1260 470 1260 520 1190 520 1190 529))
(connect D17:1 D16:1
(points 2 1073 480 1102 480))
(connect D19:0 D17:0
(points 8 1070 1038 1070 1060 1190 1060 1190 580 1090 580 1090 410 990 410 990
434))
(connect D2:1 D17:1
(points 2 837 480 907 480))
(connect D1:0 D19:0
(points 2 1070 798 1070 843))
(connect D20:1 D19:1
(points 4 772 900 790 900 790 950 971 950))
(connect D13:1 D20:0
(points 5 460 450 520 450 520 540 640 540 640 826))
(connect D11:2 D28:0
(points 3 338 780 410 780 410 814))
(connect I1:1 D29:1
(points 4 -8 -134 -460 -134 -460 60 60 60))
(connect D29:0 D30:0
(points 2 270 106 260 116)))
(stackingOrder 16 15 14 13 12 8 17 1 18 19 2 20 3 22 9 7 23 25 6 5 10 4 26 0 24
28 11 30 21 29 27))))
(device 169 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;\\red255\\green0\\blue0;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Sweep to get Corrected Data\\par\r\n\\cf2\\fs18\\par\r\n}\r\n"
)))
(device 170 NOTE
(properties
(text2 1
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang1033{\\fonttbl{\\f0\\fnil\\fcharset0 Comic Sans MS;}}\r\n{\\colortbl ;\\red0\\green0\\blue128;\\red255\\green0\\blue0;}\r\n\\viewkind4\\uc1\\pard\\cf1\\f0\\fs24 Sweep to get Raw Data\\par\r\n\\cf2\\fs18\\par\r\n}\r\n"
)))
(configuration
(connect D0:1 D1:1)
(connect D30:1 D2:1)
(connect D32:0 D3:0)
(connect D31:1 D4:1)
(connect D30:2 D5:1)
(connect D0:0 D9:0)
(connect D3:0 D10:0)
(connect D3:0 D11:0)
(connect D11:1 D12:0)
(connect D10:1 D13:0)
(connect D9:1 D22:0)
(connect D31:0 D24:0)
(connect D27:5 D24:1)
(connect D32:1 D26:1)
(connect D22:0 D27:0)
(connect D27:5 D28:1)
(connect D27:6 D28:2)
(connect D28:0 D29:0)
(connect D27:1 D29:1)
(connect D27:2 D29:2)
(connect D27:3 D29:3)
(connect D27:4 D29:4)
(connect D27:5 D29:5)
(connect D33:0 D30:0)
(connect D27:5 D30:1)
(connect D34:0 D31:0)
(connect D27:5 D31:1)
(connect D35:0 D32:0)
(connect D27:5 D32:1)
(connect D29:0 D33:0)
(connect D27:5 D33:1)
(connect D30:0 D34:0)
(connect D27:5 D34:1)
(connect D24:0 D35:0)
(connect D27:5 D35:1))
(ShowOnExecPanel))
(contextCarrier
(wndOrigin 2 2)
(wndState res)
(active panel)
(panel
(extent 797 706)
(gridSize 5)
(drawGrid "on")
(widget 1 detail
(relativeOrigin 370 10)
(PID 0)
(title on)
(tabStop off)
(tabIndex 0)
(borderStyle flat)
(extent 415 28))
(widget 3 panel
(relativeOrigin 10 290)
(bg "Light Blue Gray")
(PID 7)
(title off)
(tabIndex 7)
(borderStyle flat)
(extent 776 406)
(carbonCopy))
(widget 6 icon
(relativeOrigin 10 10)
(PID 11)
(title off)
(tabStop off)
(tabIndex 11)
(borderStyle flat)
(extent 338 48)
(iconImage "disclaim.gif")
(label off))
(widget 10 detail
(relativeOrigin 515 305)
(PID 13)
(title off)
(tabIndex 13)
(borderStyle none)
(extent 125 30))
(widget 11 detail
(relativeOrigin 645 305)
(PID 14)
(title off)
(tabIndex 14)
(borderStyle none)
(extent 125 30))
(widget 27 panel
(relativeOrigin 10 65)
(bg "Light Blue Gray")
(PID 17)
(title off)
(tabIndex 17)
(borderStyle flat)
(extent 436 210)
(carbonCopy))
(widget 8 detail
(relativeOrigin 455 65)
(PID 16)
(title off)
(tabIndex 16)
(borderStyle flat)
(extent 331 211)
(editing enabled)))
(detail
(extent 1440 994)
(anchorPt 456 399)
(configuration
(devCarrierFor 63
(active open)
(icon
(extent 125 51)
(iconImage "io.icn"))
(open
(extent 295 67))
(terminals on)
(pinCenter -300 -220))
(devCarrierFor 64
(active open)
(icon
(extent 81 0))
(open
(extent 415 37))
(pinCenter 160 -220))
(devCarrierFor 79
(active open)
(icon
(extent 70 0))
(open
(extent 121 22))
(pinCenter 380 290))
(devCarrierFor 92
(active open)
(icon
(extent 70 25))
(open
(extent 754 416)
(carbonCopy))
(terminals on)
(pinCenter 380 910))
(devCarrierFor 95
(active open)
(icon
(extent 78 0))
(open
(extent 73 51))
(terminals on)
(pinCenter 535 420))
(devCarrierFor 96
(active open)
(icon
(extent 50 0))
(open
(extent 73 51))
(terminals on)
(pinCenter 535 330))
(devCarrierFor 99
(active icon)
(icon
(extent 338 48)
(iconImage "disclaim.gif")
(label off))
(open
(extent 419 127)
(editing disabled))
(pinCenter -20 -320))
(devCarrierFor 100
(active icon)
(icon
(extent 86 51)
(iconImage "notepad.icn"))
(open
(extent 544 186)
(editing enabled))
(pinCenter -260 -320))
(devCarrierFor 101
(active icon)
(icon
(extent 166 51)
(iconImage "notepad.icn"))
(open
(extent 644 316)
(editing enabled))
(titleFont "Arial" 12 bold)
(pinCenter -450 -320))
(devCarrierFor 124
(active icon)
(icon
(extent 68 51)
(iconImage "loop.icn"))
(open)
(terminals on)
(pinCenter -300 -150))
(devCarrierFor 125
(active open)
(icon
(extent 114 0))
(open
(extent 114 24))
(title off)
(pinCenter 340 1140))
(devCarrierFor 126
(active open)
(icon
(extent 52 0))
(open
(extent 114 24))
(title off)
(pinCenter 610 1140))
(devCarrierFor 127
(active icon)
(icon
(extent 36 15))
(open)
(terminals on)
(pinCenter 770 1190))
(devCarrierFor 128
(active icon)
(icon
(extent 28 15))
(open)
(terminals on)
(pinCenter 450 1190))
(devCarrierFor 130
(active icon)
(icon
(extent 180 51)
(iconImage "notepad.icn"))
(open
(extent 410 180)
(editing enabled))
(pinCenter 260 -320))
(devCarrierFor 131
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 294 46)
(editing enabled))
(pinCenter 480 0))
(devCarrierFor 132
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 294 46)
(editing enabled))
(pinCenter 480 80))
(devCarrierFor 134
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 284 56)
(editing enabled))
(pinCenter 480 210))
(devCarrierFor 136
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 334 106)
(editing enabled))
(pinCenter -190 360))
(devCarrierFor 137
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 354 356)
(editing enabled))
(pinCenter 1050 860))
(devCarrierFor 138
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 344 106)
(editing enabled))
(pinCenter 510 1290))
(devCarrierFor 139
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 214 66)
(editing enabled))
(pinCenter -70 -130))
(devCarrierFor 140
(active icon)
(icon
(extent 148 15))
(terminals on)
(pinCenter -230 -70))
(devCarrierFor 142
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 214 86)
(editing enabled))
(pinCenter -460 -70))
(devCarrierFor 146
(active open)
(icon
(iconImage "io.icn"))
(open
(extent 229 74))
(terminals on)
(pinCenter 245 520))
(devCarrierFor 147
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 334 76)
(editing enabled))
(pinCenter -120 530))
(devCarrierFor 149
(active open)
(icon
(extent 79 0))
(open
(extent 73 51))
(terminals on)
(pinCenter 545 600))
(devCarrierFor 152
(active open)
(icon
(extent 73 105))
(open
(extent 499 210)
(carbonCopy))
(pinCenter -230 130))
(devCarrierFor 154
(active icon)
(icon
(extent 126 25))
(terminals on)
(pinCenter 240 -10))
(devCarrierFor 156
(active icon)
(icon
(extent 112 65))
(terminals on)
(pinCenter 240 90))
(devCarrierFor 159
(active icon)
(icon
(extent 97 25))
(terminals on)
(pinCenter 240 330))
(devCarrierFor 161
(active icon)
(icon
(extent 117 45))
(terminals on)
(pinCenter 240 420))
(devCarrierFor 162
(active icon)
(icon
(extent 117 45))
(terminals on)
(pinCenter 240 630))
(devCarrierFor 166
(active icon)
(icon
(extent 180 16))
(terminals on)
(pinCenter 240 220))
(devCarrierFor 167
(active icon)
(icon
(extent 172 16))
(terminals on)
(pinCenter 240 370))
(devCarrierFor 168
(active icon)
(icon
(extent 172 16))
(terminals on)
(pinCenter 240 580))
(devCarrierFor 169
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 284 56)
(editing enabled))
(pinCenter 760 380))
(devCarrierFor 170
(active open)
(icon
(iconImage "notepad.icn"))
(open
(extent 284 56)
(editing enabled))
(pinCenter 560 530))
(connect D0:1 D1:1
(points 2 -120 -220 -50 -220))
(connect D30:1 D2:1
(points 4 291 320 300 320 300 290 317 290))
(connect D32:0 D3:0
(points 6 240 655 240 670 310 670 310 660 380 660 380 681))
(connect D31:1 D4:1
(points 2 301 420 456 420))
(connect D30:2 D5:1
(points 4 291 340 310 340 310 330 456 330))
(connect D0:0 D9:0
(points 2 -300 -184 -300 -178))
(connect D3:0 D10:0
(points 6 380 1120 380 1130 370 1130 370 1120 340 1120 340 1125))
(connect D3:0 D11:0
(points 10 380 1120 380 1130 460 1130 460 1140 490 1140 490 1170 600 1170 600
1120 610 1120 610 1125))
(connect D11:1 D12:0
(points 3 669 1140 770 1140 770 1180))
(connect D10:1 D13:0
(points 3 399 1140 450 1140 450 1180))
(connect D9:1 D22:0
(points 3 -264 -150 -230 -150 -230 -80))
(connect D31:0 D24:0
(points 2 240 445 240 462))
(connect D27:5 D24:1
(points 4 22 170 70 170 70 520 88 520))
(connect D32:1 D26:1
(points 4 301 630 320 630 320 600 466 600))
(connect D22:0 D27:0
(points 2 -230 -60 -230 4))
(connect D27:5 D28:1
(points 6 22 170 70 170 70 180 140 180 140 -20 174 -20))
(connect D27:6 D28:2
(points 4 22 200 40 200 40 0 174 0))
(connect D28:0 D29:0
(points 2 240 5 240 55))
(connect D27:1 D29:1
(points 4 22 50 50 50 50 70 181 70))
(connect D27:2 D29:2
(points 2 22 80 181 80))
(connect D27:3 D29:3
(points 4 22 110 30 110 30 90 181 90))
(connect D27:4 D29:4
(points 4 22 140 50 140 50 100 181 100))
(connect D27:5 D29:5
(points 6 22 170 70 170 70 180 140 180 140 110 181 110))
(connect D33:0 D30:0
(points 2 240 230 240 315))
(connect D27:5 D30:1
(points 4 22 170 70 170 70 330 189 330))
(connect D34:0 D31:0
(points 2 240 380 240 395))
(connect D27:5 D31:1
(points 4 22 170 70 170 70 420 179 420))
(connect D35:0 D32:0
(points 2 240 590 240 605))
(connect D27:5 D32:1
(points 4 22 170 70 170 70 630 179 630))
(connect D29:0 D33:0
(points 2 240 125 240 209))
(connect D27:5 D33:1
(points 4 22 170 70 170 70 220 147 220))
(connect D30:0 D34:0
(points 2 240 345 240 359))
(connect D27:5 D34:1
(points 4 22 170 70 170 70 370 151 370))
(connect D24:0 D35:0
(points 2 240 559 240 569))
(connect D27:5 D35:1
(points 4 22 170 70 170 70 580 151 580)))
(stackingOrder 12 11 10 13 6 19 20 16 15 0 1 9 25 24 26 2 4 5 21 23 18 28 29 30
27 32 17 36 37 22 3 35 34 33 7 8 14 31))
(numberFormats
(realFormat standard)
(realSigDigits 4)
(realRadixSpec 4)
(integerBase decimal))))
