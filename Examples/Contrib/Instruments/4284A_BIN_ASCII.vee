(saveFormat "2.3")
(date "Thu 05/Feb/2004 09:43:20 ")
(veerev "6.2")
(platform "PC")
(execMode v6)
(prefExecMode v9)
(filterNAN 0)
(workspaceStackingOrder M)
(sysconfig
(iodevice "ESASPECAN"
(type GPIB)
(gateway "tsstkl24en")
(channel 7)
(subchannel 16)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "newInstrument"
(type GPIB)
(gateway "comptest1e2050a")
(channel 7)
(subchannel 8)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "newInstrument3"
(type GPIB)
(gateway "d2476cc26")
(channel 7)
(subchannel 16)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 60)
(byteOrder 0)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "newInstrument5"
(type GPIB)
(gateway "comptest3e2050a")
(channel 7)
(subchannel 14)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "ag_4395a"
(type GPIB)
(gateway "e1gunderson24en")
(channel 7)
(subchannel 24)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "hp4396a"
(type GPIB)
(gateway "This host")
(channel 0)
(subchannel 0)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(isLive 0)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "my_hp8751a_panel"
(type GPIB)
(gateway "This host")
(channel 7)
(subchannel 14)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(idFileName "hp8751a.id")
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "newInstrument2"
(type GPIB)
(gateway "comptest1e2050a")
(channel 7)
(subchannel 25)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "nwa"
(type GPIB)
(gateway "This host")
(channel 7)
(subchannel 16)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "hpe4419_pnp"
(type GPIB)
(gateway "This host")
(channel 7)
(subchannel 13)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(ppFile "HPE4419")
(ppAddr "GPIB0::13::INSTR")
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "HPEPM"
(type GPIB)
(gateway "This host")
(channel 7)
(subchannel 13)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "Hp_Epm_On_Lan"
(type GPIB)
(gateway "This host")
(channel 7)
(subchannel 13)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "EMP@704"
(type GPIB)
(gateway "This host")
(channel 7)
(subchannel 13)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "junk"
(type GPIB)
(gateway "This host")
(channel 7)
(subchannel 13)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "e4396a"
(type GPIB)
(gateway "comptest1e2050a")
(channel 7)
(subchannel 4)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "NFMeter"
(type GPIB)
(gateway "This host")
(channel 0)
(subchannel 0)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(isLive 0)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "HP856XE"
(type GPIB)
(gateway "This host")
(channel 0)
(subchannel 0)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(isLive 0)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "VNA"
(type GPIB)
(gateway "This host")
(channel 7)
(subchannel 16)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "HP53150A"
(type GPIB)
(gateway "This host")
(channel 0)
(subchannel 0)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(isLive 0)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "swap_BORD_4284a"
(type GPIB)
(gateway "This host")
(channel 7)
(subchannel 2)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 1)
(eoiEnabled 1)
(model ""
(standard 488)))
(iodevice "keysight_4284a"
(type GPIB)
(gateway "eng-dhcp-7")
(channel 7)
(subchannel 2)
(readTerm "\n")
(fs ",")
(eol "\n")
(multiField dataOnly)
(arrayFormat linear)
(timeout 5)
(byteOrder 0)
(eoiEnabled 1)
(model ""
(standard 488))))
(SaveCF no)
(device 0 ROOTCONTEXT
(properties
(trigMode deg)
(nextID 49)
(popupTitleText "Untitled")
(popupMoveable 1)
(deleteGlobals 0))
(deviceList
(UserFunctions
(nextID 1)
(context 0
(properties
(name "err_report")
(trigMode deg)
(nextID 8)
(popupTitleText "UserFunction")
(popupMoveable 1))
(interface
(output 1
(type data)
(name "X")
(lock constraints)
(optional yes)))
(deviceList
(device 0 REPEATUNTILBREAK
(interface
(output 1
(name "Continuous")
(lock name constraints))))
(device 1 IODEVICE
(properties
(name "keysight_4284a ( @ 702 on eng-dhcp-7)")
(transactions 2 "WRITE TEXT \"SYST:ERR?\" EOL" "READ TEXT x STR"))
(interface
(output 1
(name "x")
(optional yes)))
(implementation
(iopath "keysight_4284a")))
(device 2 IFTHENELSE
(properties
(cases 1 "A==0"))
(interface
(input 1
(name "A")
(requires
(datatype Int32))
(optional yes))
(output 1
(name "Then")
(lock name constraints))
(output 2
(name "Else")
(lock name constraints))))
(device 5 BREAK)
(device 6 START25)
(device 7 COLLECTOR
(properties
(output1D 0))
(interface
(input 1
(name "Data")
(tag "Data"))
(input 2
(type trigger)
(name "XEQ")
(lock name constraints))
(output 1
(name "Array")
(tag "Array"))))
(configuration
(connect D4:0 D0:0)
(connect D0:1 D1:0)
(connect D1:0 D2:0)
(connect D1:1 D2:1)
(connect D5:1 D3:0)
(connect D1:1 D5:1)
(connect D2:1 D5:2)
(connect D5:1 O1:1)))
(contextCarrier
(active detail)
(detail
(extent 934 302)
(anchorPt 33 126)
(configuration
(devCarrierFor 0
(active icon)
(icon
(extent 68 51)
(iconImage "loop.icn"))
(open)
(terminals on)
(pinCenter 100 80))
(devCarrierFor 1
(active open)
(icon
(iconImage "io.icn"))
(open
(extent 229 74))
(terminals on)
(pinCenter 210 180))
(devCarrierFor 2
(active open)
(icon)
(open
(extent 73 51))
(terminals on)
(pinCenter 205 310))
(devCarrierFor 5
(active icon)
(icon
(extent 55 25))
(open)
(terminals on)
(pinCenter 510 250))
(devCarrierFor 6
(active open)
(icon)
(open
(extent 47 22))
(title off)
(pinCenter 100 30))
(devCarrierFor 7
(active icon)
(icon
(extent 53 25))
(open)
(terminals on)
(pinCenter 450 190))
(connect D4:0 D0:0
(points 2 100 43 100 52))
(connect D0:1 D1:0
(points 3 136 80 210 80 210 122))
(connect D1:0 D2:0
(points 2 210 219 210 264))
(connect D1:1 D2:1
(points 6 357 180 380 180 380 240 120 240 120 310 136 310))
(connect D5:1 D3:0
(points 3 479 190 510 190 510 235))
(connect D1:1 D5:1
(points 2 357 180 421 180))
(connect D2:1 D5:2
(points 4 284 300 390 300 390 200 421 200))
(connect D5:1 O1:1
(points 4 479 190 510 190 510 24 900 24)))
(stackingOrder 1 4 0 2 5 3)))))
(device 0 IODEVICE
(properties
(name "keysight_4284a ( @ 702 on eng-dhcp-7)")
(transactions 6 "WRITE TEXT \"*CLS\" EOL" "WRITE TEXT \"*IDN?\" EOL"
"READ TEXT x STR" "WRITE TEXT \"TRIG:SOUR BUS\" EOL"
"WRITE TEXT \"ABORT;:INIT\" EOL" "WRITE TEXT \"TRIGGER:IMMEDIATE\" EOL"))
(interface
(output 1
(name "x")
(optional yes)))
(implementation
(iopath "keysight_4284a")))
(device 1 START25)
(device 3 TEXTDISPLAY
(interface
(input 1
(name "Data"))))
(device 4 IODEVICE
(properties
(name "keysight_4284a ( @ 702 on eng-dhcp-7)")
(transactions 3 "WRITE TEXT \"FORM:DATA ASCII\" EOL" "WRITE TEXT \"FETC?\" EOL"
"READ TEXT x STR"))
(interface
(output 1
(name "x")
(optional yes)))
(implementation
(iopath "keysight_4284a")))
(device 5 IODEVICE
(properties
(name "keysight_4284a ( @ 702 on eng-dhcp-7)")
(transactions 7 "WRITE TEXT \"FORM:DATA REAL,64\" EOL"
"WRITE TEXT \"TRIGGER:IMMEDIATE\" EOL" "WRITE TEXT \"FETC?\" EOL"
"READ TEXT header_stuff STR MAXFW:2" "READ TEXT numBytes INT16 MAXFW:2"
"READ BINARY stuff REAL64 ARRAY:(numBytes-1)/8" "READ BINARY lastByte BYTE"))
(interface
(output 1
(name "header_stuff")
(optional yes))
(output 2
(name "numBytes")
(optional yes))
(output 3
(name "stuff")
(optional yes))
(output 4
(name "that")
(optional yes))
(output 5
(name "lastByte")
(optional yes)))
(implementation
(iopath "keysight_4284a")))
(device 17 TEXTDISPLAY
(properties
(name "Read from ASCII"))
(interface
(input 1
(name "Data"))))
(device 23 TEXTDISPLAY
(interface
(input 1
(name "Data"))))
(device 27 TEXTDISPLAY
(properties
(name "Read as BIN BLOCK form"))
(interface
(input 1
(name "Data"))))
(device 38 TEXTDISPLAY
(interface
(input 1
(name "Data"))))
(device 40 TEXTDISPLAY
(interface
(input 1
(name "Data"))))
(device 41 TEXTDISPLAY
(interface
(input 1
(name "Data"))))
(device 46 CALL
(properties
(name "Call err_report")
(callFunc "err_report")
(parmMode rev30))
(interface
(output 1
(name "X")
(lock name constraints)
(optional yes))))
(device 47 TEXTDISPLAY
(interface
(input 1
(name "Data"))))
(device 48 NOTE
(properties
(name "ABOUT: 4284A_binAndAscii.vee")
(text2 11 "An Keysight Vee example for outlining how to extract either ASCII or "
"BINARY data transfers from the 4284A Impedance Analyzer. Note that the "
"program provides an example of using a \"user function\", specifically the "
"\"err_report\" user function. This function queries the instrument\'s error "
"queue in a loop until a \"+0, \"No Error\"\"  error condition is reported. "
"Most instruments have some form of an error buffer. Typically errors are "
"stored up to a predefined maximum number or count. The errors can be "
"extracted via the error query. Since this instrument is IEEE 488.2 "
"compliant it supports the \"SYSTem:ERRor?\" query command. "
"One way to entirely clear the error queue is to query the buffer until "
"the +0, \"No Error\" condition is reported.")))
(configuration
(connect D1:0 D0:0)
(connect D0:1 D2:1)
(connect D0:0 D3:0)
(connect D3:0 D4:0)
(connect D3:1 D5:1)
(connect D4:1 D6:1)
(connect D4:3 D7:1)
(connect D4:2 D8:1)
(connect D4:4 D9:1)
(connect D4:5 D10:1)
(connect D4:0 D11:0)
(connect D11:1 D12:1)))
(contextCarrier
(wndRestoredOrigin 2 2)
(wndRestoredExtent 920 476)
(wndState max)
(active detail)
(detail
(extent 1020 633)
(anchorPt 63 -39)
(configuration
(devCarrierFor 0
(active open)
(icon
(iconImage "io.icn"))
(open
(extent 275 127))
(terminals on)
(pinCenter 170 170))
(devCarrierFor 1
(active open)
(icon)
(open
(extent 35 25))
(title off)
(pinCenter 170 60))
(devCarrierFor 3
(active open)
(icon)
(open
(extent 365 37))
(pinCenter 540 170))
(devCarrierFor 4
(active open)
(icon
(iconImage "io.icn"))
(open
(extent 265 77))
(terminals on)
(pinCenter 170 320))
(devCarrierFor 5
(active open)
(icon
(iconImage "io.icn"))
(open
(extent 325 197))
(terminals on)
(pinCenter 140 490))
(devCarrierFor 17
(active open)
(icon
(extent 100 0))
(open
(extent 285 27))
(pinCenter 500 320))
(devCarrierFor 23
(active open)
(icon)
(open
(extent 115 27))
(pinCenter 470 410))
(devCarrierFor 27
(active open)
(icon
(extent 177 0))
(open
(extent 213 87)
(arFont "Arial" 14 bold))
(titleFont "Arial" 14)
(pinCenter 700 480))
(devCarrierFor 38
(active open)
(icon)
(open
(extent 135 27))
(pinCenter 760 390))
(devCarrierFor 40
(active open)
(icon)
(open
(extent 135 27))
(pinCenter 500 530))
(devCarrierFor 41
(active open)
(icon)
(open
(extent 135 27))
(pinCenter 660 570))
(devCarrierFor 46
(active icon)
(icon
(extent 86 15))
(open
(extent 176 51))
(terminals on)
(pinCenter 170 640))
(devCarrierFor 47
(active open)
(icon)
(open
(extent 165 37))
(pinCenter 550 640))
(devCarrierFor 48
(active icon)
(icon
(extent 224 52)
(iconImage "notepad.icn"))
(open
(extent 645 227)
(editing enabled))
(bg "Med Light Gray")
(titleBg "Light Teal")
(titleFont "Arial" 14)
(pinCenter 470 240))
(connect D1:0 D0:0
(points 2 170 75 170 86))
(connect D0:1 D2:1
(points 2 340 170 355 170))
(connect D0:0 D3:0
(points 2 170 236 170 261))
(connect D3:0 D4:0
(points 2 170 361 170 371))
(connect D3:1 D5:1
(points 2 335 320 355 320))
(connect D4:1 D6:1
(points 2 395 410 410 410))
(connect D4:3 D7:1
(points 4 395 490 410 490 410 480 591 480))
(connect D4:2 D8:1
(points 4 395 450 550 450 550 390 690 390))
(connect D4:4 D9:1
(points 2 395 530 430 530))
(connect D4:5 D10:1
(points 2 395 570 590 570))
(connect D4:0 D11:0
(points 2 170 591 170 630))
(connect D11:1 D12:1
(points 2 215 640 465 640)))
(stackingOrder 1 0 3 4 12 5 2 11 13 10 9 6 8 7))
(numberFormats
(realFormat standard)
(realSigDigits 4)
(realRadixSpec 4)
(integerBase decimal))))
